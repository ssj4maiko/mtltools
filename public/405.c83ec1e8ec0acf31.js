(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[405],{7405:(_t,at,F)=>{"use strict";F.r(at),F.d(at,{EntryModule:()=>dt});var Y=F(6895),H=F(4793),K=F(4131),t=F(4650),k=F(4006);let rt=(()=>{class u{constructor(r){this.formBuilder=r,this.indexes=[],this.entries=[]}createForm(r,n,e){this.formEntries=e.map(i=>new K.GK(i)),console.log(this.formEntries),this.addItem()}addItem(){this.formEntries.push(new K.GK(null,this.idCategory))}onChange(r,n){r.reset?this.formEntries[n]=this.entries[n]?new K.GK(this.entries[n]):new K.GK(null,this.idCategory):(r.delete?this.entries[n]?this.formEntries[n].delete=!0:this.formEntries.splice(n,1):this.formEntries[n].update=this.formEntries[n].id&&(this.formEntries[n].idCategory!==this.entries[n].idCategory||this.formEntries[n].entryOriginal!==this.entries[n].entryOriginal||this.formEntries[n].entryTranslation!==this.entries[n].entryTranslation||this.formEntries[n].description!==this.entries[n].description),this.checkIfNeedsToAutoAddAnExtraItem())}checkIfNeedsToAutoAddAnExtraItem(){const r=this.formEntries[this.formEntries.length-1];(r.entryOriginal||r.entryTranslation||r.description)&&this.addItem()}getValues(){return{entries:this.formEntries}}}return u.\u0275fac=function(r){return new(r||u)(t.LFG(k.qu))},u.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();var V=F(6845),ft=F(230),f=F(3028);let G=(()=>{let u=class{constructor(){this._papa=f}parse(r,n){return this._papa.parse(r,n)}unparse(r,n){return this._papa.unparse(r,n)}setLocalChunkSize(r){this._papa.LocalChunkSize=r}setRemoteChunkSize(r){this._papa.RemoteChunkSize=r}setDefaultDelimiter(r){this._papa.DefaultDelimiter=r}get badDelimiters(){return this._papa.BAD_DELIMITERS}get recordSeparator(){return this._papa.RECORD_SEP}get unitSeparator(){return this._papa.UNIT_SEP}get workersSupported(){return this._papa.WORKERS_SUPPORTED}};return u.\u0275fac=function(r){return new(r||u)},u.\u0275prov=(0,t.Yz7)({factory:function(){return new u},token:u,providedIn:"root"}),u})();function J(u,m){1&u&&(t.TgZ(0,"div",9),t._UZ(1,"div",10),t.qZA())}function tt(u,m){if(1&u){const r=t.EpF();t.TgZ(0,"div",9),t.TgZ(1,"div",10),t.TgZ(2,"button",11),t.NdJ("click",function(){return t.CHM(r),t.oxw().submitForm()}),t._uU(3,"Save"),t.qZA(),t.qZA(),t.TgZ(4,"div",10),t.TgZ(5,"a",11),t.NdJ("click",function(){return t.CHM(r),t.oxw().addItem()}),t._uU(6,"Add Entry"),t.qZA(),t.qZA(),t.qZA()}}function et(u,m){1&u&&t.GkF(0)}function W(u,m){if(1&u&&(t.TgZ(0,"option",22),t._uU(1),t.qZA()),2&u){const r=m.$implicit;t.s9C("value",r.id),t.xp6(1),t.Oqu(r.name)}}const nt=function(u,m,r){return{new:u,deleted:m,changed:r}};function ct(u,m){if(1&u){const r=t.EpF();t.ynx(0),t.TgZ(1,"tr",12),t.TgZ(2,"td"),t.TgZ(3,"select",13),t.NdJ("change",function(){const e=t.CHM(r),i=e.$implicit,s=e.index;return t.oxw().onChange(i,s)})("ngModelChange",function(e){return t.CHM(r).$implicit.idCategory=e}),t.YNc(4,W,2,2,"option",14),t.qZA(),t.qZA(),t.TgZ(5,"td"),t.TgZ(6,"input",15),t.NdJ("change",function(){const e=t.CHM(r),i=e.$implicit,s=e.index;return t.oxw().onChange(i,s)})("ngModelChange",function(e){return t.CHM(r).$implicit.id=e}),t.qZA(),t.TgZ(7,"input",15),t.NdJ("change",function(){const e=t.CHM(r),i=e.$implicit,s=e.index;return t.oxw().onChange(i,s)})("ngModelChange",function(e){return t.CHM(r).$implicit.update=e}),t.qZA(),t.TgZ(8,"input",16),t.NdJ("change",function(){const e=t.CHM(r),i=e.$implicit,s=e.index;return t.oxw().onChange(i,s)})("ngModelChange",function(e){return t.CHM(r).$implicit.entryOriginal=e}),t.qZA(),t.qZA(),t.TgZ(9,"td"),t.TgZ(10,"input",16),t.NdJ("change",function(){const e=t.CHM(r),i=e.$implicit,s=e.index;return t.oxw().onChange(i,s)})("ngModelChange",function(e){return t.CHM(r).$implicit.entryTranslation=e}),t.qZA(),t.qZA(),t.TgZ(11,"td"),t.TgZ(12,"textarea",17),t.NdJ("change",function(){const e=t.CHM(r),i=e.$implicit,s=e.index;return t.oxw().onChange(i,s)})("ngModelChange",function(e){return t.CHM(r).$implicit.description=e}),t.qZA(),t.qZA(),t.TgZ(13,"td"),t.TgZ(14,"label",18),t._UZ(15,"i",19),t.TgZ(16,"input",20),t.NdJ("change",function(){const e=t.CHM(r),i=e.$implicit,s=e.index;return t.oxw().onChange(i,s)})("ngModelChange",function(e){return t.CHM(r).$implicit.reset=e}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"td"),t.TgZ(18,"label",18),t._UZ(19,"i",21),t.TgZ(20,"input",20),t.NdJ("change",function(){const e=t.CHM(r),i=e.$implicit,s=e.index;return t.oxw().onChange(i,s)})("ngModelChange",function(e){return t.CHM(r).$implicit.delete=e}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&u){const r=m.$implicit,n=m.index,e=t.oxw();t.xp6(1),t.Q6J("ngClass",t.kEZ(18,nt,null==r.id,1==r.delete,1==r.update)),t.xp6(2),t.MGl("name","formEntries[",n,"].idCategory"),t.Q6J("ngModel",r.idCategory),t.xp6(1),t.Q6J("ngForOf",e.categories),t.xp6(2),t.MGl("name","formEntries[",n,"].id"),t.Q6J("ngModel",r.id),t.xp6(1),t.MGl("name","formEntries[",n,"].update"),t.Q6J("ngModel",r.update),t.xp6(1),t.MGl("name","formEntries[",n,"].entryOriginal"),t.Q6J("ngModel",r.entryOriginal),t.xp6(2),t.MGl("name","formEntries[",n,"].entryTranslation"),t.Q6J("ngModel",r.entryTranslation),t.xp6(2),t.MGl("name","formEntries[",n,"].description"),t.Q6J("ngModel",r.description),t.xp6(4),t.MGl("name","formEntries[",n,"].reset"),t.Q6J("ngModel",r.reset),t.xp6(4),t.MGl("name","formEntries[",n,"].delete"),t.Q6J("ngModel",r.delete)}}function X(u,m){1&u&&t.GkF(0)}const pt=[{path:"",component:(()=>{class u extends rt{constructor(r,n,e,i,s,o){super(i),this.router=r,this.route=n,this.api=e,this.formBuilder=i,this.modalService=s,this.papa=o,this.categories=[],this.tmpResult=[]}ngOnInit(){this.idDictionary=this.route.snapshot.params.idDictionary,this.idCategory=this.route.snapshot.params.idCategory,Promise.all([this.api.Dictionary.get({id:this.idDictionary}),this.api.Category.getAll({idDictionary:this.idDictionary}),this.api.Entry.getAll({idDictionary:this.idDictionary,idCategory:this.idCategory})]).then(r=>{this.api.Category.get({idDictionary:this.idDictionary,id:this.idCategory}).then(n=>{this.dictionary=r[0],this.categories=Object.values(r[1]),this.entries=Object.values(r[2]),this.createForm(this.idDictionary,this.idCategory,this.entries)})})}ngOnDestroy(){delete this.entries,delete this.dictionary,delete this.categories,delete this.formGroup,delete this.entryArray,delete this.idCategory,delete this.idDictionary,console.log("DESTROY!")}submitForm(){const r=this.getValues();this.api.Entry.saveByCategory({idDictionary:this.idDictionary,idCategory:this.idCategory,entries:r.entries}).then(n=>{n?this.router.navigate(["/dictionary/",this.idDictionary]):console.log("THERE WAS AN ERROR!")})}}return u.\u0275fac=function(r){return new(r||u)(t.Y36(H.F0),t.Y36(H.gz),t.Y36(V.s),t.Y36(k.qu),t.Y36(ft.Z),t.Y36(G))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-list"]],hostBindings:function(r,n){1&r&&t.NdJ("blur",function(i){return n.onBlur(i)})},features:[t.qOj],decls:27,vars:5,consts:[["actionButtons",""],["footerButtons",""],[4,"ngTemplateOutlet"],["id","formGroup",3,"submit"],["type","hidden","name","idDictionary",3,"ngModel","ngModelChange"],["type","hidden","name","idCategory",3,"ngModel","ngModelChange"],[1,"table","is-stripede","is-fullwidth"],[1,"tableContent"],[4,"ngFor","ngForOf"],[1,"columns","actionButtons"],[1,"column"],[1,"button","is-info",3,"click"],[3,"ngClass"],[3,"name","ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","hidden",3,"name","ngModel","change","ngModelChange"],["type","text",1,"input",3,"name","ngModel","change","ngModelChange"],["rows","1",1,"textarea",3,"name","ngModel","change","ngModelChange"],[1,"icon","is-large"],[1,"fas","fa-exclamation-triangle"],["type","checkbox","value","1",1,"hidden",3,"name","ngModel","change","ngModelChange"],[1,"fas","fa-times"],[3,"value"]],template:function(r,n){if(1&r&&(t.YNc(0,J,2,0,"ng-template",null,0,t.W1O),t.YNc(2,tt,7,0,"ng-template",null,1,t.W1O),t.YNc(4,et,1,0,"ng-container",2),t.TgZ(5,"div"),t.TgZ(6,"form",3),t.NdJ("submit",function(){return n.submitForm()}),t.TgZ(7,"input",4),t.NdJ("ngModelChange",function(i){return n.idDictionary=i}),t.qZA(),t.TgZ(8,"input",5),t.NdJ("ngModelChange",function(i){return n.idCategory=i}),t.qZA(),t.TgZ(9,"table",6),t.TgZ(10,"thead"),t.TgZ(11,"tr"),t.TgZ(12,"th"),t._uU(13,"Category"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Original"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Translated"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Description"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Reset"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"Delete"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(24,"tbody",7),t.YNc(25,ct,21,22,"ng-container",8),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(26,X,1,0,"ng-container",2)),2&r){const e=t.MAs(3);t.xp6(4),t.Q6J("ngTemplateOutlet",e),t.xp6(3),t.Q6J("ngModel",n.idDictionary),t.xp6(1),t.Q6J("ngModel",n.idCategory),t.xp6(17),t.Q6J("ngForOf",n.formEntries),t.xp6(1),t.Q6J("ngTemplateOutlet",e)}},directives:[Y.tP,k._Y,k.JL,k.F,k.Fj,k.JJ,k.On,Y.sg,Y.mk,k.EJ,k.YN,k.Kr,k.Wl],styles:[".actionButtons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .actionButtons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{text-align:center;width:100%}.hidden[_ngcontent-%COMP%]{display:none}.tableContent[_ngcontent-%COMP%]   .changed[_ngcontent-%COMP%]{background-color:green}.tableContent[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%]{background-color:#00f}.tableContent[_ngcontent-%COMP%]   .deleted[_ngcontent-%COMP%]{background-color:red}"]}),u})(),data:{title:"List Entries"}},{path:"**",redirectTo:""}];let ht=(()=>{class u{}return u.\u0275fac=function(r){return new(r||u)},u.\u0275mod=t.oAB({type:u}),u.\u0275inj=t.cJS({imports:[[H.Bz.forChild(pt)],H.Bz]}),u})(),dt=(()=>{class u{}return u.\u0275fac=function(r){return new(r||u)},u.\u0275mod=t.oAB({type:u}),u.\u0275inj=t.cJS({imports:[[Y.ez,ht,k.u5,k.UX]]}),u})()},3028:function(_t,at){var F,H;F=function K(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},k=!t.document&&!!t.postMessage,rt=k&&/blob:/i.test((t.location||{}).protocol),V={},ft=0,f={parse:function(n,e){var i=(e=e||{}).dynamicTyping||!1;if(r(i)&&(e.dynamicTypingFunction=i,i={}),e.dynamicTyping=i,e.transform=!!r(e.transform)&&e.transform,e.worker&&f.WORKERS_SUPPORTED){var s=function(){if(!f.WORKERS_SUPPORTED)return!1;var R,T,p=(R=t.URL||t.webkitURL||null,T=K.toString(),f.BLOB_URL||(f.BLOB_URL=R.createObjectURL(new Blob(["(",T,")();"],{type:"text/javascript"})))),g=new t.Worker(p);return g.onmessage=pt,g.id=ft++,V[g.id]=g}();return s.userStep=e.step,s.userChunk=e.chunk,s.userComplete=e.complete,s.userError=e.error,e.step=r(e.step),e.chunk=r(e.chunk),e.complete=r(e.complete),e.error=r(e.error),delete e.worker,void s.postMessage({input:n,config:e,workerId:s.id})}var o=null;return"string"==typeof n?o=e.download?new tt(e):new W(e):!0===n.readable&&r(n.read)&&r(n.on)?o=new nt(e):(t.File&&n instanceof File||n instanceof Object)&&(o=new et(e)),o.stream(n)},unparse:function(n,e){var i=!1,s=!0,o=",",p="\r\n",g='"',R=g+g,T=!1,c=null,M=!1;!function(){if("object"==typeof e){if("string"!=typeof e.delimiter||f.BAD_DELIMITERS.filter(function(a){return-1!==e.delimiter.indexOf(a)}).length||(o=e.delimiter),("boolean"==typeof e.quotes||"function"==typeof e.quotes||Array.isArray(e.quotes))&&(i=e.quotes),"boolean"!=typeof e.skipEmptyLines&&"string"!=typeof e.skipEmptyLines||(T=e.skipEmptyLines),"string"==typeof e.newline&&(p=e.newline),"string"==typeof e.quoteChar&&(g=e.quoteChar),"boolean"==typeof e.header&&(s=e.header),Array.isArray(e.columns)){if(0===e.columns.length)throw new Error("Option columns is empty");c=e.columns}void 0!==e.escapeChar&&(R=e.escapeChar+g),"boolean"==typeof e.escapeFormulae&&(M=e.escapeFormulae)}}();var l=new RegExp(X(g),"g");if("string"==typeof n&&(n=JSON.parse(n)),Array.isArray(n)){if(!n.length||Array.isArray(n[0]))return U(null,n,T);if("object"==typeof n[0])return U(c||Object.keys(n[0]),n,T)}else if("object"==typeof n)return"string"==typeof n.data&&(n.data=JSON.parse(n.data)),Array.isArray(n.data)&&(n.fields||(n.fields=n.meta&&n.meta.fields),n.fields||(n.fields=Array.isArray(n.data[0])?n.fields:"object"==typeof n.data[0]?Object.keys(n.data[0]):[]),Array.isArray(n.data[0])||"object"==typeof n.data[0]||(n.data=[n.data])),U(n.fields||[],n.data||[],T);throw new Error("Unable to serialize unrecognized input");function U(a,E,b){var D="";"string"==typeof a&&(a=JSON.parse(a)),"string"==typeof E&&(E=JSON.parse(E));var S=Array.isArray(a)&&0<a.length,w=!Array.isArray(E[0]);if(S&&s){for(var O=0;O<a.length;O++)0<O&&(D+=o),D+=Z(a[O],O);0<E.length&&(D+=p)}for(var h=0;h<E.length;h++){var y=S?a.length:E[h].length,v=!1,x=S?0===Object.keys(E[h]).length:0===E[h].length;if(b&&!S&&(v="greedy"===b?""===E[h].join("").trim():1===E[h].length&&0===E[h][0].length),"greedy"===b&&S){for(var C=[],_=0;_<y;_++)C.push(E[h][w?a[_]:_]);v=""===C.join("").trim()}if(!v){for(var d=0;d<y;d++)0<d&&!x&&(D+=o),D+=Z(E[h][S&&w?a[d]:d],d);h<E.length-1&&(!b||0<y&&!x)&&(D+=p)}}return D}function Z(a,E){if(null==a)return"";if(a.constructor===Date)return JSON.stringify(a).slice(1,25);!0===M&&"string"==typeof a&&null!==a.match(/^[=+\-@].*$/)&&(a="'"+a);var b=a.toString().replace(l,R);return"boolean"==typeof i&&i||"function"==typeof i&&i(a,E)||Array.isArray(i)&&i[E]||function(S,w){for(var O=0;O<w.length;O++)if(-1<S.indexOf(w[O]))return!0;return!1}(b,f.BAD_DELIMITERS)||-1<b.indexOf(o)||" "===b.charAt(0)||" "===b.charAt(b.length-1)?g+b+g:b}}};if(f.RECORD_SEP=String.fromCharCode(30),f.UNIT_SEP=String.fromCharCode(31),f.BYTE_ORDER_MARK="\ufeff",f.BAD_DELIMITERS=["\r","\n",'"',f.BYTE_ORDER_MARK],f.WORKERS_SUPPORTED=!k&&!!t.Worker,f.NODE_STREAM_INPUT=1,f.LocalChunkSize=10485760,f.RemoteChunkSize=5242880,f.DefaultDelimiter=",",f.Parser=ut,f.ParserHandle=ct,f.NetworkStreamer=tt,f.FileStreamer=et,f.StringStreamer=W,f.ReadableStreamStreamer=nt,t.jQuery){var G=t.jQuery;G.fn.parse=function(n){var e=n.config||{},i=[];return this.each(function(p){if("INPUT"!==G(this).prop("tagName").toUpperCase()||"file"!==G(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var g=0;g<this.files.length;g++)i.push({file:this.files[g],inputElem:this,instanceConfig:G.extend({},e)})}),s(),this;function s(){if(0!==i.length){var g,R,T,c=i[0];if(r(n.before)){var M=n.before(c.file,c.inputElem);if("object"==typeof M){if("abort"===M.action)return"AbortError",g=c.file,R=c.inputElem,T=M.reason,void(r(n.error)&&n.error({name:"AbortError"},g,R,T));if("skip"===M.action)return void o();"object"==typeof M.config&&(c.instanceConfig=G.extend(c.instanceConfig,M.config))}else if("skip"===M)return void o()}var l=c.instanceConfig.complete;c.instanceConfig.complete=function(U){r(l)&&l(U,c.file,c.inputElem),o()},f.parse(c.file,c.instanceConfig)}else r(n.complete)&&n.complete()}function o(){i.splice(0,1),s()}}}function J(n){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var i=u(e);i.chunkSize=parseInt(i.chunkSize),e.step||e.chunk||(i.chunkSize=null),this._handle=new ct(i),(this._handle.streamer=this)._config=i}.call(this,n),this.parseChunk=function(e,i){if(this.isFirstChunk&&r(this._config.beforeFirstChunk)){var s=this._config.beforeFirstChunk(e);void 0!==s&&(e=s)}this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+e;this._partialLine="";var p=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var g=p.meta.cursor;this._finished||(this._partialLine=o.substring(g-this._baseIndex),this._baseIndex=g),p&&p.data&&(this._rowCount+=p.data.length);var R=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(rt)t.postMessage({results:p,workerId:f.WORKER_ID,finished:R});else if(r(this._config.chunk)&&!i){if(this._config.chunk(p,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);p=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(p.data),this._completeResults.errors=this._completeResults.errors.concat(p.errors),this._completeResults.meta=p.meta),this._completed||!R||!r(this._config.complete)||p&&p.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),R||p&&p.meta.paused||this._nextChunk(),p}this._halted=!0},this._sendError=function(e){r(this._config.error)?this._config.error(e):rt&&this._config.error&&t.postMessage({workerId:f.WORKER_ID,error:e,finished:!1})}}function tt(n){var e;(n=n||{}).chunkSize||(n.chunkSize=f.RemoteChunkSize),J.call(this,n),this._nextChunk=k?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(i){this._input=i,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),k||(e.onload=m(this._chunkLoaded,this),e.onerror=m(this._chunkError,this)),e.open(this._config.downloadRequestBody?"POST":"GET",this._input,!k),this._config.downloadRequestHeaders){var i=this._config.downloadRequestHeaders;for(var s in i)e.setRequestHeader(s,i[s])}this._config.chunkSize&&e.setRequestHeader("Range","bytes="+this._start+"-"+(this._start+this._config.chunkSize-1));try{e.send(this._config.downloadRequestBody)}catch(p){this._chunkError(p.message)}k&&0===e.status&&this._chunkError()}},this._chunkLoaded=function(){var s;4===e.readyState&&(e.status<200||400<=e.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:e.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null===(s=e.getResponseHeader("Content-Range"))?-1:parseInt(s.substring(s.lastIndexOf("/")+1))),this.parseChunk(e.responseText)))},this._chunkError=function(i){this._sendError(new Error(e.statusText||i))}}function et(n){var e,i;(n=n||{}).chunkSize||(n.chunkSize=f.LocalChunkSize),J.call(this,n);var s="undefined"!=typeof FileReader;this.stream=function(o){this._input=o,i=o.slice||o.webkitSlice||o.mozSlice,s?((e=new FileReader).onload=m(this._chunkLoaded,this),e.onerror=m(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var o=this._input;if(this._config.chunkSize){var p=Math.min(this._start+this._config.chunkSize,this._input.size);o=i.call(o,this._start,p)}var g=e.readAsText(o,this._config.encoding);s||this._chunkLoaded({target:{result:g}})},this._chunkLoaded=function(o){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(o.target.result)},this._chunkError=function(){this._sendError(e.error)}}function W(n){var e;J.call(this,n=n||{}),this.stream=function(i){return e=i,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var i,s=this._config.chunkSize;return s?(i=e.substring(0,s),e=e.substring(s)):(i=e,e=""),this._finished=!e,this.parseChunk(i)}}}function nt(n){J.call(this,n=n||{});var e=[],i=!0,s=!1;this.pause=function(){J.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){J.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(o){this._input=o,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){s&&1===e.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):i=!0},this._streamData=m(function(o){try{e.push("string"==typeof o?o:o.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(p){this._streamError(p)}},this),this._streamError=m(function(o){this._streamCleanUp(),this._sendError(o)},this),this._streamEnd=m(function(){this._streamCleanUp(),s=!0,this._streamData("")},this),this._streamCleanUp=m(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function ct(n){var e,i,s,o=Math.pow(2,53),p=-o,g=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,R=/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))$/,T=this,c=0,M=0,l=!1,U=!1,Z=[],a={data:[],errors:[],meta:{}};if(r(n.step)){var E=n.step;n.step=function(h){if(a=h,S())D();else{if(D(),0===a.data.length)return;c+=h.data.length,n.preview&&c>n.preview?i.abort():(a.data=a.data[0],E(a,T))}}}function b(h){return"greedy"===n.skipEmptyLines?""===h.join("").trim():1===h.length&&0===h[0].length}function D(){if(a&&s&&(O("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+f.DefaultDelimiter+"'"),s=!1),n.skipEmptyLines)for(var h=0;h<a.data.length;h++)b(a.data[h])&&a.data.splice(h--,1);return S()&&function(){if(a)if(Array.isArray(a.data[0])){for(var v=0;S()&&v<a.data.length;v++)a.data[v].forEach(y);a.data.splice(0,1)}else a.data.forEach(y);function y(x,C){r(n.transformHeader)&&(x=n.transformHeader(x,C)),Z.push(x)}}(),function(){if(!a||!n.header&&!n.dynamicTyping&&!n.transform)return a;function y(x,C){var _,A=n.header?{}:[];for(_=0;_<x.length;_++){var d=_,I=x[_];n.header&&(d=_>=Z.length?"__parsed_extra":Z[_]),n.transform&&(I=n.transform(I,d)),I=w(d,I),"__parsed_extra"===d?(A[d]=A[d]||[],A[d].push(I)):A[d]=I}return n.header&&(_>Z.length?O("FieldMismatch","TooManyFields","Too many fields: expected "+Z.length+" fields but parsed "+_,M+C):_<Z.length&&O("FieldMismatch","TooFewFields","Too few fields: expected "+Z.length+" fields but parsed "+_,M+C)),A}var v=1;return!a.data.length||Array.isArray(a.data[0])?(a.data=a.data.map(y),v=a.data.length):a.data=y(a.data,0),n.header&&a.meta&&(a.meta.fields=Z),M+=v,a}()}function S(){return n.header&&0===Z.length}function w(h,y){return v=h,n.dynamicTypingFunction&&void 0===n.dynamicTyping[v]&&(n.dynamicTyping[v]=n.dynamicTypingFunction(v)),!0===(n.dynamicTyping[v]||n.dynamicTyping)?"true"===y||"TRUE"===y||"false"!==y&&"FALSE"!==y&&(function(x){if(g.test(x)){var C=parseFloat(x);if(p<C&&C<o)return!0}return!1}(y)?parseFloat(y):R.test(y)?new Date(y):""===y?null:y):y;var v}function O(h,y,v,x){var C={type:h,code:y,message:v};void 0!==x&&(C.row=x),a.errors.push(C)}this.parse=function(h,y,v){if(n.newline||(n.newline=function(A,d){A=A.substring(0,1048576);var I=new RegExp(X(d)+"([^]*?)"+X(d),"gm"),z=(A=A.replace(I,"")).split("\r"),N=A.split("\n");if(1===z.length||1<N.length&&N[0].length<z[0].length)return"\n";for(var B=0,P=0;P<z.length;P++)"\n"===z[P][0]&&B++;return B>=z.length/2?"\r\n":"\r"}(h,n.quoteChar||'"')),s=!1,n.delimiter)r(n.delimiter)&&(n.delimiter=n.delimiter(h),a.meta.delimiter=n.delimiter);else{var C=function(A,d,I,z,N){var Q,B,P,L;N=N||[",","\t","|",";",f.RECORD_SEP,f.UNIT_SEP];for(var $=0;$<N.length;$++){var q=N[$],it=0,j=0,gt=0;P=void 0;for(var st=new ut({comments:z,delimiter:q,newline:d,preview:10}).parse(A),lt=0;lt<st.data.length;lt++)if(I&&b(st.data[lt]))gt++;else{var ot=st.data[lt].length;j+=ot,void 0!==P?0<ot&&(it+=Math.abs(ot-P),P=ot):P=ot}0<st.data.length&&(j/=st.data.length-gt),(void 0===B||it<=B)&&(void 0===L||L<j)&&1.99<j&&(B=it,Q=q,L=j)}return{successful:!!(n.delimiter=Q),bestDelimiter:Q}}(h,n.newline,n.skipEmptyLines,n.comments,n.delimitersToGuess);C.successful?n.delimiter=C.bestDelimiter:(s=!0,n.delimiter=f.DefaultDelimiter),a.meta.delimiter=n.delimiter}var _=u(n);return n.preview&&n.header&&_.preview++,e=h,i=new ut(_),a=i.parse(e,y,v),D(),l?{meta:{paused:!0}}:a||{meta:{paused:!1}}},this.paused=function(){return l},this.pause=function(){l=!0,i.abort(),e=r(n.chunk)?"":e.substring(i.getCharIndex())},this.resume=function(){T.streamer._halted?(l=!1,T.streamer.parseChunk(e,!0)):setTimeout(T.resume,3)},this.aborted=function(){return U},this.abort=function(){U=!0,i.abort(),a.meta.aborted=!0,r(n.complete)&&n.complete(a),e=""}}function X(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ut(n){var e,i=(n=n||{}).delimiter,s=n.newline,o=n.comments,p=n.step,g=n.preview,R=n.fastMode,T=e=void 0===n.quoteChar?'"':n.quoteChar;if(void 0!==n.escapeChar&&(T=n.escapeChar),("string"!=typeof i||-1<f.BAD_DELIMITERS.indexOf(i))&&(i=","),o===i)throw new Error("Comment character same as delimiter");!0===o?o="#":("string"!=typeof o||-1<f.BAD_DELIMITERS.indexOf(o))&&(o=!1),"\n"!==s&&"\r"!==s&&"\r\n"!==s&&(s="\n");var c=0,M=!1;this.parse=function(l,U,Z){if("string"!=typeof l)throw new Error("Input must be a string");var a=l.length,E=i.length,b=s.length,D=o.length,S=r(p),w=[],O=[],h=[],y=c=0;if(!l)return L();if(R||!1!==R&&-1===l.indexOf(e)){for(var v=l.split(s),x=0;x<v.length;x++){if(c+=(h=v[x]).length,x!==v.length-1)c+=s.length;else if(Z)return L();if(!o||h.substring(0,D)!==o){if(S){if(w=[],N(h.split(i)),$(),M)return L()}else N(h.split(i));if(g&&g<=x)return w=w.slice(0,g),L(!0)}}return L()}for(var C=l.indexOf(i,c),_=l.indexOf(s,c),A=new RegExp(X(T)+X(e),"g"),d=l.indexOf(e,c);;)if(l[c]!==e)if(o&&0===h.length&&l.substring(c,c+D)===o){if(-1===_)return L();_=l.indexOf(s,c=_+b),C=l.indexOf(i,c)}else if(-1!==C&&(C<_||-1===_))h.push(l.substring(c,C)),C=l.indexOf(i,c=C+E);else{if(-1===_)break;if(h.push(l.substring(c,_)),P(_+b),S&&($(),M))return L();if(g&&w.length>=g)return L(!0)}else for(d=c,c++;;){if(-1===(d=l.indexOf(e,d+1)))return Z||O.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:w.length,index:c}),B();if(d===a-1)return B(l.substring(c,d).replace(A,e));if(e!==T||l[d+1]!==T){if(e===T||0===d||l[d-1]!==T){-1!==C&&C<d+1&&(C=l.indexOf(i,d+1)),-1!==_&&_<d+1&&(_=l.indexOf(s,d+1));var I=Q(-1===_?C:Math.min(C,_));if(l[d+1+I]===i){h.push(l.substring(c,d).replace(A,e)),l[c=d+1+I+E]!==e&&(d=l.indexOf(e,c)),C=l.indexOf(i,c),_=l.indexOf(s,c);break}var z=Q(_);if(l.substring(d+1+z,d+1+z+b)===s){if(h.push(l.substring(c,d).replace(A,e)),P(d+1+z+b),C=l.indexOf(i,c),d=l.indexOf(e,c),S&&($(),M))return L();if(g&&w.length>=g)return L(!0);break}O.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:w.length,index:c}),d++}}else d++}return B();function N(q){w.push(q),y=c}function Q(q){var it=0;if(-1!==q){var j=l.substring(d+1,q);j&&""===j.trim()&&(it=j.length)}return it}function B(q){return Z||(void 0===q&&(q=l.substring(c)),h.push(q),c=a,N(h),S&&$()),L()}function P(q){c=q,N(h),h=[],_=l.indexOf(s,c)}function L(q){return{data:w,errors:O,meta:{delimiter:i,linebreak:s,aborted:M,truncated:!!q,cursor:y+(U||0)}}}function $(){p(L()),w=[],O=[]}},this.abort=function(){M=!0},this.getCharIndex=function(){return c}}function pt(n){var e=n.data,i=V[e.workerId],s=!1;if(e.error)i.userError(e.error,e.file);else if(e.results&&e.results.data){var o={abort:function(){s=!0,ht(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:dt,resume:dt};if(r(i.userStep)){for(var p=0;p<e.results.data.length&&(i.userStep({data:e.results.data[p],errors:e.results.errors,meta:e.results.meta},o),!s);p++);delete e.results}else r(i.userChunk)&&(i.userChunk(e.results,o,e.file),delete e.results)}e.finished&&!s&&ht(e.workerId,e.results)}function ht(n,e){var i=V[n];r(i.userComplete)&&i.userComplete(e),i.terminate(),delete V[n]}function dt(){throw new Error("Not implemented.")}function u(n){if("object"!=typeof n||null===n)return n;var e=Array.isArray(n)?[]:{};for(var i in n)e[i]=u(n[i]);return e}function m(n,e){return function(){n.apply(e,arguments)}}function r(n){return"function"==typeof n}return rt&&(t.onmessage=function(n){var e=n.data;if(void 0===f.WORKER_ID&&e&&(f.WORKER_ID=e.workerId),"string"==typeof e.input)t.postMessage({workerId:f.WORKER_ID,results:f.parse(e.input,e.config),finished:!0});else if(t.File&&e.input instanceof File||e.input instanceof Object){var i=f.parse(e.input,e.config);i&&t.postMessage({workerId:f.WORKER_ID,results:i,finished:!0})}}),(tt.prototype=Object.create(J.prototype)).constructor=tt,(et.prototype=Object.create(J.prototype)).constructor=et,(W.prototype=Object.create(W.prototype)).constructor=W,(nt.prototype=Object.create(J.prototype)).constructor=nt,f},void 0!==(H=F.apply(at,[]))&&(_t.exports=H)}}]);