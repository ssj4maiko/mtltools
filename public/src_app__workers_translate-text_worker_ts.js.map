{"version":3,"file":"src_app__workers_translate-text_worker_ts.js","mappings":"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","sources":["webpack/bootstrap","webpack/runtime/make namespace object","./src/app/_workers/translate-text.worker.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/// <reference lib=\"webworker\" />\n\nimport { DictionaryCategory } from \"../_models/dictionarycategory\";\nimport { DictionaryEntry, EntryForm } from \"../_models/dictionaryentry\";\n\n//import { DictionaryCategory, DictionaryEntry } from \"../_models\";\nconst scapeRegex = (entry:string) => {\n  return entry.replace('-','\\\\-')\n              .replace('[','\\\\[')\n              .replace(']','\\\\]')\n              .replace('(','\\\\(')\n              .replace(')','\\\\)')\n              ;\n}\nconst replaceTextAllEntries = (entries: DictionaryEntry[], cloneText: string, cloneTitle: string) => {\n  while (entries.length !== 0) {\n    const entry = entries.pop();\n    const regex = new RegExp(scapeRegex(entry.entryOriginal), 'g');\n    const replace = entry.entryTranslation.length === 0 ? '' : '\\[' + entry.idCategory + '\\[<span class=\"replaced\" '\n      + (entry.description ? `title=\"${entry.description}\"` : '')\n      + ' id=\"replaced-' + entry.index[0] + '-' + entry.index[1] + '\">'\n      + entry.entryTranslation\n      + '</span>\\]' + entry.idCategory + '\\]';\n    cloneTitle = cloneTitle.replace(regex, replace);\n    cloneText = cloneText.replace(regex, replace);\n  }\n  return [cloneText, cloneTitle];\n}\nconst replaceTextAllFixes = (entries: DictionaryEntry[], cloneText: string, cloneTitle: string) => {\n  while (entries.length !== 0) {\n    const entry = entries.pop();\n    let regex, replace;\n\n    if (entry.sufix) {\n      regex = new RegExp('(\\]' + entry.sufix + '\\]' + scapeRegex(entry.entryOriginal) + ')', 'g');\n      replace = '<span class=\"replaced sufix\" '\n        + (entry.description ? `title=\"${entry.description}\"` : '')\n        + ' id=\"replaced-' + entry.index[0] + '-' + entry.index[1] + '\">'\n        + entry.entryTranslation\n        + '</span>\\]' + entry.idCategory + '\\]';\n\n    } else {\n      regex = new RegExp('(' + scapeRegex(entry.entryOriginal) + '\\\\[' + entry.prefix + '\\\\[)', 'g');\n      replace = '\\[' + entry.idCategory + '\\[<span class=\"replaced prefix\" '\n        + (entry.description ? `title=\"${entry.description}\"` : '')\n        + ' id=\"replaced-' + entry.index[0] + '-' + entry.index[1] + '\">'\n        + entry.entryTranslation\n        + '</span>';\n    }\n    cloneTitle = cloneTitle.replace(regex, replace);\n    cloneText = cloneText.replace(regex, replace);\n  }\n  return [cloneText, cloneTitle];\n}\naddEventListener('message', (data:MessageEvent) => {\n  let {categories, text, title} = data.data as {categories:DictionaryCategory[], text:string, title:string};\n  if (categories.length > 0) {\n    let entries: DictionaryEntry[][] = [];\n    let entriesFixes: DictionaryEntry[][] = [];\n    categories.forEach((category, i) => {\n      // Newly created Categories don't come with Entries, so let's not break the code\n      if (category.entries) {\n        category.entries.forEach((entry:EntryForm, j) => {\n          // Newly created Entries won't have the variables set by default, which would break the code on AOT\n          if (entry.entryOriginal && !entry.delete) {\n            let regex = new RegExp('(\\\\p{P})+', 'gu');\n            const simplified = entry.entryOriginal.replace(regex, '');\n            const length = simplified.length;\n            const insert = {\n              entryOriginal: entry.entryOriginal,\n              entryTranslation: entry.entryTranslation,\n              description: entry.description,\n              id: entry.id,\n              idCategory: category.id,\n              category: category.name,\n              simplified: simplified,\n              index: [i, j]\n            } as DictionaryEntry;\n\n            if ((!entry.sufix && !entry.prefix)) {\n              if (!entries[length]) {\n                entries[length] = [];\n              }\n              entries[length].push(insert);\n            } else {\n\n              insert.sufix = entry.sufix;\n              insert.prefix = entry.prefix;\n\n              if (!entriesFixes[length]) {\n                entriesFixes[length] = [];\n              }\n              entriesFixes[length].push(insert);\n            }\n          }\n        });\n      }\n    });\n    try {\n      for (let i = entries.length; i >= 0; --i) {\n        if (entries[i]) {\n          [text, title] = replaceTextAllEntries(entries[i], text, title);\n        }\n      }\n      for (let i = entriesFixes.length; i >= 0; --i) {\n        if (entriesFixes[i]) {\n          [text, title] = replaceTextAllFixes(entriesFixes[i], text, title);\n        }\n      }\n      console.log('finished translation');\n    } catch (e) {\n      console.error('TIMEOUT', e);\n    }\n    // The extra characters are to allow to create a space in between translated words\n    const regexEnd = '\\\\][0-9]+\\\\]';\n    const regexStart = '\\\\[[0-9]+\\\\[';\n    try {\n      let regex = new RegExp('(' + regexEnd + regexStart + ')+', 'gm');\n      title = title.replace(regex, ' ');\n      text = text.replace(regex, ' ');\n      regex = new RegExp('(' + regexEnd + ')+', 'gm');\n      title = title.replace(regex, '');\n      text = text.replace(regex, '');\n      regex = new RegExp('(' + regexStart + ')+', 'gm');\n      title = title.replace(regex, '');\n      text = text.replace(regex, '');\n    } catch (e) {\n      console.info(regexEnd + regexStart);\n      console.error(e)\n    }\n  }\n\n  postMessage({\n    text,\n    title\n  });\n\n});\n"],"names":["scapeRegex","entry","replace","replaceTextAllEntries","entries","cloneText","cloneTitle","length","pop","regex","RegExp","entryOriginal","entryTranslation","idCategory","description","index","replaceTextAllFixes","sufix","prefix","addEventListener","data","categories","text","title","entriesFixes","forEach","category","i","j","delete","simplified","insert","id","name","push","console","log","e","error","regexEnd","regexStart","info","postMessage"],"sourceRoot":"webpack:///"}