"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[12],{4012:(Nt,O,g)=>{g.r(O),g.d(O,{ChapterModule:()=>wt});var d=g(6895),p=g(1457);function m(o,a,e,n,i,r,c){try{var l=o[r](c),_=l.value}catch(M){return void e(M)}l.done?a(_):Promise.resolve(_).then(n,i)}function h(o){return function(){var a=this,e=arguments;return new Promise(function(n,i){var r=o.apply(a,e);function c(_){m(r,n,i,c,l,"next",_)}function l(_){m(r,n,i,c,l,"throw",_)}c(void 0)})}}var v=g(2340),t=g(6738),C=g(6845);function E(o,a){1&o&&(t.TgZ(0,"div",12)(1,"a",15),t._uU(2,"Import Chapter"),t.qZA()())}const P=function(o,a){return{"is-danger":o,"is-info":a}};function N(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",12)(1,"a",16),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).updateChapters()}),t._uU(2,"Update Chapters"),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.WLB(1,P,e.disableupdate>0,0==e.disableupdate))}}function L(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",12)(1,"a",16),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).updateAllChapters()}),t._uU(2,"Update All Chapters (Alternative)"),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.WLB(1,P,e.disableupdate>0,0==e.disableupdate))}}const J=function(o){return["/novel/",o,"dictionary"]};function A(o,a){if(1&o&&(t.TgZ(0,"div",11)(1,"div",12)(2,"a",13),t._uU(3,"Dictionary"),t.qZA()(),t.YNc(4,E,3,0,"div",14),t.YNc(5,N,3,4,"div",14),t.YNc(6,L,3,4,"div",14),t.qZA()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("routerLink",t.VKq(4,J,e.idNovel)),t.xp6(2),t.Q6J("ngIf",e.novel&&"manual"==e.novel.driver),t.xp6(1),t.Q6J("ngIf",e.novel&&"manual"!=e.novel.driver),t.xp6(1),t.Q6J("ngIf",e.novel&&"kakuyomu"==e.novel.driver)}}function B(o,a){if(1&o&&(t.TgZ(0,"div",17)(1,"p"),t._uU(2,"Name:"),t._UZ(3,"br"),t.TgZ(4,"b"),t._uU(5),t.qZA()(),t.TgZ(6,"p"),t._uU(7,"Original:"),t._UZ(8,"br"),t.TgZ(9,"b"),t._uU(10),t.qZA()(),t.TgZ(11,"p"),t._uU(12,"Number of Chapters:"),t._UZ(13,"br"),t.TgZ(14,"b"),t._uU(15),t.qZA()(),t.TgZ(16,"p"),t._uU(17,"Source:"),t._UZ(18,"br"),t.TgZ(19,"a",18),t._uU(20),t.qZA()()()),2&o){const e=t.oxw();t.xp6(5),t.Oqu(e.novel.nameCustom),t.xp6(5),t.Oqu(e.novel.nameOriginal),t.xp6(5),t.Oqu(e.novel.numberChapters),t.xp6(4),t.s9C("href",e.novel.urlSource,t.LSH),t.xp6(1),t.Oqu(e.novel.urlSource)}}function D(o,a){1&o&&t.GkF(0)}function q(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"i",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().sort("number","-")}),t.qZA()}}function Q(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"i",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().sort("number","+")}),t.qZA()}}function I(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"i",21),t.NdJ("click",function(){return t.CHM(e),t.oxw().sort("title","-")}),t.qZA()}}function H(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"i",22),t.NdJ("click",function(){return t.CHM(e),t.oxw().sort("title","+")}),t.qZA()}}function U(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"i",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().sort("created","-")}),t.qZA()}}function F(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"i",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().sort("created","+")}),t.qZA()}}function Y(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"i",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().sort("updated","-")}),t.qZA()}}function $(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"i",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().sort("updated","+")}),t.qZA()}}function j(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"p")(1,"a",27),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw().$implicit;return t.oxw().openGT(c,r)}),t._uU(2),t.qZA()()}if(2&o){const e=a.$implicit;t.xp6(2),t.Oqu(e.language)}}function R(o,a){1&o&&t._UZ(0,"i",32)}function V(o,a){1&o&&t._UZ(0,"i",33)}function G(o,a){1&o&&(t.TgZ(0,"a",34)(1,"span",35),t._UZ(2,"i",36),t.qZA()())}function W(o,a){1&o&&(t.TgZ(0,"a",37)(1,"span",35),t._UZ(2,"i",38),t.qZA()())}const z=function(o){return{disabled:o}},f=function(o,a){return["/novel/",o,a]};function K(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr",23)(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td",24),t._uU(5),t.qZA(),t.TgZ(6,"td",24),t._uU(7),t.qZA(),t.TgZ(8,"td",24),t._uU(9),t.qZA(),t.TgZ(10,"td",24),t._uU(11),t.qZA(),t.TgZ(12,"td"),t.YNc(13,j,3,1,"p",10),t.qZA(),t.TgZ(14,"td"),t.YNc(15,R,1,0,"i",25),t.YNc(16,V,1,0,"i",26),t.TgZ(17,"a",27),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw().updateChapter(r.no)}),t._UZ(18,"i",28),t.qZA(),t.TgZ(19,"a",18),t._UZ(20,"i",29),t.qZA()(),t.YNc(21,G,3,0,"ng-template",null,30,t.W1O),t.YNc(23,W,3,0,"ng-template",null,31,t.W1O),t.qZA(),t.BQk()}if(2&o){const e=a.$implicit,n=t.oxw();t.xp6(1),t.s9C("title",n.novel.title),t.Q6J("ngClass",t.VKq(15,z,n.updating&&n.updating[e.no])),t.xp6(2),t.Oqu(e.no),t.xp6(1),t.Q6J("routerLink",t.WLB(17,f,e.idNovel,e.no)),t.xp6(1),t.Oqu(e.arc),t.xp6(1),t.Q6J("routerLink",t.WLB(20,f,e.idNovel,e.no)),t.xp6(1),t.Oqu(e.title),t.xp6(1),t.Q6J("routerLink",t.WLB(23,f,e.idNovel,e.no)),t.xp6(1),t.Oqu(e.dateOriginalPost),t.xp6(1),t.Q6J("routerLink",t.WLB(26,f,e.idNovel,e.no)),t.xp6(1),t.Oqu(e.dateOriginalRevision),t.xp6(2),t.Q6J("ngForOf",n.dictionaries),t.xp6(2),t.Q6J("ngIf",!e.hasText),t.xp6(1),t.Q6J("ngIf",e.hasText),t.xp6(3),t.s9C("href",e.urlSource,t.LSH)}}const x=function(o){return{orderedBy:o}};let X=(()=>{class o{constructor(e,n,i){this.router=e,this.route=n,this.api=i,this.chapters=[],this.dictionaries=[],this.updating=[],this.sortingAlg={numberAsc:(r,c)=>r.no>c.no,titleAsc:(r,c)=>r.title>c.title,createdAsc:(r,c)=>r.dateCreated>c.dateCreated,updatedAsc:(r,c)=>(r.dateRevision??r.dateCreated)>(c.dateRevision??c.dateCreated),numberDesc:(r,c)=>r.no<c.no,titleDesc:(r,c)=>r.title<c.title,createdDesc:(r,c)=>r.dateCreated<c.dateCreated,updatedDesc:(r,c)=>(r.dateRevision??r.dateCreated)<(c.dateRevision??c.dateCreated)},this.currentSort={by:"number",dir:"-"},this.disableupdate=0}sort(e,n){this.currentSort.by=e,this.currentSort.dir=n,this.chapters.sort(this.sortingAlg[this.currentSort.by+("+"==n?"Asc":"Desc")])}ngOnInit(){this.idNovel=this.route.snapshot.params.idNovel,this.api.Novel.get({id:this.idNovel}).then(e=>{this.novel=e,this.api.Dictionary.getAll({idNovel:this.idNovel}).then(n=>{this.dictionaries=Object.values(n),this.api.Chapter.getAll({idNovel:this.idNovel}).then(i=>{this.chapters=Object.values(i),this.sort(this.currentSort.by,this.currentSort.dir)})})})}updateChapter(e){var n=this;return h(function*(){return n.updating[e]=!0,n.disableupdate++,n.api.Chapter.chapterAutoUpdate({idNovel:n.idNovel,no:e}).then(i=>{console.log("Chapter updated",i),--n.disableupdate,n.api.Chapter.getAll({idNovel:n.idNovel}).then(r=>{n.chapters=Object.values(r),n.sort(n.currentSort.by,n.currentSort.dir)}),delete n.updating[e]},i=>{console.log(i)})})()}updateAllChapters(){var e=this;return h(function*(){if(0==e.disableupdate)for(let n=0;n<e.chapters.length;++n)yield new Promise(i=>{e.updateChapter(e.chapters[n].no).then(()=>{i(!0)})})})()}openGT(e,n){let i=`${v.N.backendServer}/static/${this.idNovel}/${n.id}/${e.no}/1`;i="https://translate.google.com/translate?sl=auto&tl=en&u="+i,window.open(i)}updateChapters(){this.disableupdate++,this.api.Chapter.autoUpdate({idNovel:this.idNovel}).then(e=>{--this.disableupdate,this.api.Chapter.getAll({idNovel:this.idNovel}).then(n=>{this.chapters=Object.values(n),this.sort(this.currentSort.by,this.currentSort.dir)})},e=>{console.log(e)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.F0),t.Y36(p.gz),t.Y36(C.s))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-chapter-list"]],decls:34,vars:23,consts:[["actionButtons",""],["id","novelInfo",4,"ngIf"],["id","novelTable"],[4,"ngTemplateOutlet"],[1,"table","is-striped","is-hoverable"],[3,"ngClass"],["class","fas fa-sort-numeric-down",3,"click",4,"ngIf"],["class","fas fa-sort-numeric-up",3,"click",4,"ngIf"],["class","fas fa-sort-alpha-down",3,"click",4,"ngIf"],["class","fas fa-sort-alpha-up",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"columns","actionButtons"],[1,"column"],[1,"button","is-primary",3,"routerLink"],["class","column",4,"ngIf"],["routerLink","['/novel/',idNovel,'add']",1,"button","is-info"],[1,"button",3,"ngClass","click"],["id","novelInfo"],["target","_blank",3,"href"],[1,"fas","fa-sort-numeric-down",3,"click"],[1,"fas","fa-sort-numeric-up",3,"click"],[1,"fas","fa-sort-alpha-down",3,"click"],[1,"fas","fa-sort-alpha-up",3,"click"],[3,"title","ngClass"],[3,"routerLink"],["class","fas fa-align-justify is-danger","title","Text is not loaded",4,"ngIf"],["class","fas fa-align-justify","title","Text is loaded",4,"ngIf"],[3,"click"],["title","Update Chapter",1,"has-text-info","fas","fa-sync"],["title","Source",1,"has-text-info","fas","fa-external-link-alt"],["success",""],["danger",""],["title","Text is not loaded",1,"fas","fa-align-justify","is-danger"],["title","Text is loaded",1,"fas","fa-align-justify"],[1,"button","is-success"],[1,"icon","is-small"],[1,"fas","fa-check"],[1,"button","is-danger"],[1,"fas","fa-times"]],template:function(e,n){if(1&e&&(t.YNc(0,A,7,6,"ng-template",null,0,t.W1O),t.YNc(2,B,21,5,"div",1),t.TgZ(3,"div",2),t.YNc(4,D,1,0,"ng-container",3),t.TgZ(5,"table",4)(6,"thead")(7,"tr")(8,"th",5),t._uU(9," Number "),t.YNc(10,q,1,0,"i",6),t.YNc(11,Q,1,0,"i",7),t.qZA(),t.TgZ(12,"th"),t._uU(13," Arc "),t.qZA(),t.TgZ(14,"th",5),t._uU(15," Title "),t.YNc(16,I,1,0,"i",8),t.YNc(17,H,1,0,"i",9),t.qZA(),t.TgZ(18,"th",5),t._uU(19," Date Created "),t.YNc(20,U,1,0,"i",6),t.YNc(21,F,1,0,"i",7),t.qZA(),t.TgZ(22,"th",5),t._uU(23," Date Updated "),t.YNc(24,Y,1,0,"i",6),t.YNc(25,$,1,0,"i",7),t.qZA(),t.TgZ(26,"th"),t._uU(27," Dictionary"),t._UZ(28,"br"),t._uU(29,"Google Translator "),t.qZA(),t.TgZ(30,"th"),t._uU(31," Actions "),t.qZA()()(),t.TgZ(32,"tbody"),t.YNc(33,K,25,29,"ng-container",10),t.qZA()()()),2&e){const i=t.MAs(1);t.xp6(2),t.Q6J("ngIf",n.novel),t.xp6(2),t.Q6J("ngTemplateOutlet",i),t.xp6(4),t.Q6J("ngClass",t.VKq(15,x,"number"==n.currentSort.by)),t.xp6(2),t.Q6J("ngIf","number"!=n.currentSort.by||"-"!=n.currentSort.dir),t.xp6(1),t.Q6J("ngIf","number"==n.currentSort.by&&"-"==n.currentSort.dir),t.xp6(3),t.Q6J("ngClass",t.VKq(17,x,"title"==n.currentSort.by)),t.xp6(2),t.Q6J("ngIf","title"!=n.currentSort.by||"-"!=n.currentSort.dir),t.xp6(1),t.Q6J("ngIf","title"==n.currentSort.by&&"-"==n.currentSort.dir),t.xp6(1),t.Q6J("ngClass",t.VKq(19,x,"created"==n.currentSort.by)),t.xp6(2),t.Q6J("ngIf","created"!=n.currentSort.by||"-"!=n.currentSort.dir),t.xp6(1),t.Q6J("ngIf","created"==n.currentSort.by&&"-"==n.currentSort.dir),t.xp6(1),t.Q6J("ngClass",t.VKq(21,x,"updated"==n.currentSort.by)),t.xp6(2),t.Q6J("ngIf","updated"!=n.currentSort.by||"-"!=n.currentSort.dir),t.xp6(1),t.Q6J("ngIf","updated"==n.currentSort.by&&"-"==n.currentSort.dir),t.xp6(8),t.Q6J("ngForOf",n.chapters)}},directives:[p.yS,d.O5,d.mk,d.tP,d.sg,p.rH],styles:["#novelInfo[_ngcontent-%COMP%]{width:100%;padding:20px;float:left;border-radius:20px;background-color:#8700f680}#novelInfo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:block;width:400px;margin:0 30px;float:left}#novelInfo[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;font-weight:700}#novelTable[_ngcontent-%COMP%]{float:left;width:100%;min-width:1459px}#novelTable[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}#novelTable[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.disabled[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{background-color:#b3c7ff}#novelTable[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .orderedBy[_ngcontent-%COMP%]{color:#fff;background-color:#ffffff4d}#novelTable[_ngcontent-%COMP%]   .fas[_ngcontent-%COMP%]{margin:3px;font-size:20px;vertical-align:super;cursor:pointer}#novelTable[_ngcontent-%COMP%]   .columns[_ngcontent-%COMP%]{margin:5px}#novelTable[_ngcontent-%COMP%]   .actionButtons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-align:center;width:100%}#novelTable[_ngcontent-%COMP%]   .actionButtons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{background-color:#888}"]}),o})();var y=g(3178),tt=g(2414);let et=(()=>{class o{constructor(e){this.api=e,this.categories=[],this.categoriesOriginalValues=[],this.indexes=[]}rebuildCache(e){var n=this;this.api.Category.getAll({idDictionary:this.idDictionary}).then(function(){var i=h(function*(r){n.categories=Object.values(r);const c=[];n.categories.forEach(function(){var l=h(function*(_,M){c.push(new Promise((Zt,Lt)=>{n.api.Entry.getAll({idDictionary:n.idDictionary,idCategory:_.id}).then(function(){var kt=h(function*(k){c.push(new Promise(function(){var St=h(function*(S,Et){_.entries=Object.values(k),S()});return function(S,Et){return St.apply(this,arguments)}}()))});return function(k){return kt.apply(this,arguments)}}()),Zt()}))});return function(_,M){return l.apply(this,arguments)}}()),Promise.all(c).then(l=>{n.categoriesOriginalValues=JSON.parse(JSON.stringify(n.categories)),e()})});return function(r){return i.apply(this,arguments)}}())}addEntry(e,n,i,r){e.entries||(e.entries=[]),e.entries.push(new y.y(r)),setTimeout(()=>{let c,l;if(this.DOMcategories){let _=this.DOMcategories.toArray()[i];_&&(c=_.nativeElement)}c||(c=document.getElementById("categoryDOM-"+i)),l=c.children[c.children.length-2].children[0],l.focus()},150)}duplicateEntry(e,n,i,r){let c=JSON.parse(JSON.stringify(r));delete c.id,this.addEntry(e,n,i,c)}addCategory(){this.categories.push(new tt.c(null,this.idDictionary))}changeEntry(e,n,i,r){e.reset?this.categories[n].entries[i]=this.categories[n].entries[i].id?new y.y(this.categoriesOriginalValues[n].entries[i]):new y.y(null,this.categories[n].id):e.delete?e.id||this.categories[n].entries.splice(i,1):e.id&&(e.update=e.entryOriginal!==this.categoriesOriginalValues[n].entries[i].entryOriginal||e.entryTranslation!==this.categoriesOriginalValues[n].entries[i].entryTranslation||e.description!==this.categoriesOriginalValues[n].entries[i].description||e.idCategory!==this.categoriesOriginalValues[n].entries[i].idCategory||e.sufix!==this.categoriesOriginalValues[n].entries[i].sufix||e.prefix!==this.categoriesOriginalValues[n].entries[i].prefix)}changeCategory(e,n){e.id&&(e.update=e.name!==this.categoriesOriginalValues[n].name)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(C.s))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var s=g(5236),u=g(4719);function nt(o,a){if(1&o&&(t.TgZ(0,"option",24),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.Oqu(e.language)}}function it(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"li",18)(1,"input",19),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).refreshTranslation()}),t.qZA(),t.TgZ(2,"input",20),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).refreshOriginal()}),t.qZA(),t.TgZ(3,"select",21),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw(2).dictionarySelector=i})("change",function(i){return t.CHM(e),t.oxw(2).dictionarySelected(i.target.value)}),t.TgZ(4,"option",22),t._uU(5,"Choose a language"),t.qZA(),t.YNc(6,nt,2,2,"option",23),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("ngModel",e.dictionarySelector),t.xp6(3),t.Q6J("ngForOf",e.dictionaries)}}const ot=function(o,a,e){return{changed:o,new:a,"category-selected":e}};function rt(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"li")(2,"h1",25),t.NdJ("click",function(){const r=t.CHM(e).index;return t.oxw(2).selectOpenCategory=r}),t.TgZ(3,"input",26),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.name=i})("ngModelChange",function(){const i=t.CHM(e),r=i.$implicit,c=i.index;return t.oxw(2).changeCategory(r,c)}),t.qZA()()(),t.BQk()}if(2&o){const e=a.$implicit,n=a.index,i=t.oxw(2);t.xp6(2),t.Q6J("ngClass",t.kEZ(3,ot,1==e.update,null==e.id,i.selectOpenCategory==n)),t.xp6(1),t.MGl("id","category-",n,""),t.Q6J("ngModel",e.name)}}function ct(o,a){if(1&o&&(t.TgZ(0,"option",24),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.Oqu(e.name)}}function at(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"select",46),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().$implicit.sufix=i})("change",function(){t.CHM(e);const i=t.oxw(),r=i.$implicit,c=i.index,l=t.oxw().index;return t.oxw(2).changeEntry(r,l,c)}),t.TgZ(1,"option",47),t._uU(2,"Select a Category for the suffix"),t.qZA(),t.YNc(3,ct,2,2,"option",23),t.qZA()}if(2&o){const e=t.oxw(),n=e.index,i=e.$implicit,r=t.oxw().index,c=t.oxw(2);t.hYB("id","entry-",r,"-",n,"-sufix"),t.Q6J("ngModel",i.sufix),t.xp6(3),t.Q6J("ngForOf",c.categoriesOriginalValues)}}function st(o,a){if(1&o&&(t.TgZ(0,"option",24),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.s9C("value",e.id),t.xp6(1),t.Oqu(e.name)}}function lt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"select",46),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().$implicit.prefix=i})("change",function(){t.CHM(e);const i=t.oxw(),r=i.$implicit,c=i.index,l=t.oxw().index;return t.oxw(2).changeEntry(r,l,c)}),t.TgZ(1,"option",47),t._uU(2,"Select a Category for the Prefix"),t.qZA(),t.YNc(3,st,2,2,"option",23),t.qZA()}if(2&o){const e=t.oxw(),n=e.index,i=e.$implicit,r=t.oxw().index,c=t.oxw(2);t.hYB("id","entry-",r,"-",n,"-prefix"),t.Q6J("ngModel",i.prefix),t.xp6(3),t.Q6J("ngForOf",c.categoriesOriginalValues)}}const _t=function(o,a,e){return{changed:o,deleted:a,new:e}},gt=function(o,a,e,n){return{fas:o,"fa-angle-right":a,"fa-angle-left":e,"far fa-times-circle":n}},dt=function(o,a){return{"entry-translation-half":o,"entry-translation":a}};function pt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",32)(1,"input",33,34),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.entryOriginal=i})("focus",function(){const r=t.CHM(e).index;return t.oxw(3).selectedEntry=r})("ngModelChange",function(){const i=t.CHM(e),r=i.$implicit,c=i.index,l=t.oxw().index;return t.oxw(2).changeEntry(r,l,c)}),t.qZA(),t.TgZ(3,"label",35),t._UZ(4,"i",16),t.TgZ(5,"input",36),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.sefixButton=i})("change",function(){const i=t.CHM(e),r=i.$implicit,c=i.index,l=t.oxw().index;return t.oxw(2).activateSufix(r,l,c)}),t.qZA()(),t.YNc(6,at,4,4,"select",37),t.TgZ(7,"input",38),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.entryTranslation=i})("focus",function(){const r=t.CHM(e).index;return t.oxw(3).selectedEntry=r})("ngModelChange",function(){const i=t.CHM(e),r=i.$implicit,c=i.index,l=t.oxw().index;return t.oxw(2).changeEntry(r,l,c)}),t.qZA(),t.YNc(8,lt,4,4,"select",37),t.TgZ(9,"input",39),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.description=i})("focus",function(){const r=t.CHM(e).index;return t.oxw(3).selectedEntry=r})("ngModelChange",function(){const i=t.CHM(e),r=i.$implicit,c=i.index,l=t.oxw().index;return t.oxw(2).changeEntry(r,l,c)}),t.qZA(),t.TgZ(10,"label",40),t._UZ(11,"i",41),t.TgZ(12,"input",42),t.NdJ("change",function(){const i=t.CHM(e),r=i.$implicit,c=i.index,l=t.oxw().index,_=t.oxw(2);return r.delete=!0,_.changeEntry(r,l,c)}),t.qZA()(),t.TgZ(13,"label",43),t._UZ(14,"i",44),t.TgZ(15,"input",45),t.NdJ("change",function(){const i=t.CHM(e),r=i.$implicit,c=i.index,l=t.oxw().index,_=t.oxw(2);return r.reset=!0,_.changeEntry(r,l,c)}),t.qZA()()()}if(2&o){const e=a.$implicit,n=a.index,i=t.oxw().index;t.Q6J("ngClass",t.kEZ(15,_t,1==e.update,1==e.delete,null==e.id)),t.xp6(1),t.hYB("id","entry-",i,"-",n,""),t.Q6J("ngModel",e.entryOriginal),t.xp6(3),t.Q6J("ngClass",t.l5B(19,gt,e.sufix||e.prefix,e.sufix,e.prefix,!e.sufix&&!e.prefix)),t.xp6(1),t.Q6J("ngModel",e.sefixButton),t.xp6(1),t.Q6J("ngIf",e.sufix),t.xp6(1),t.hYB("id","entry-",i,"-",n,"-trans"),t.Q6J("ngClass",t.WLB(24,dt,e.sufix||e.prefix,!e.sufix&&!e.prefix))("ngModel",e.entryTranslation),t.xp6(1),t.Q6J("ngIf",e.prefix),t.xp6(1),t.hYB("id","entry-",i,"-",n,"-desc"),t.Q6J("ngModel",e.description)}}const b=function(o){return{hidden:o}};function ut(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"li",16)(2,"div",27,28),t.YNc(4,pt,16,27,"div",29),t._UZ(5,"div",30),t.qZA(),t.TgZ(6,"input",31),t.NdJ("click",function(){const i=t.CHM(e),r=i.$implicit,c=i.index;return t.oxw(2).addEntry(r,r.id,c)}),t.qZA()(),t.BQk()}if(2&o){const e=a.$implicit,n=a.index,i=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.VKq(3,b,i.selectOpenCategory!=n)),t.xp6(1),t.MGl("id","categoryDOM-",n,""),t.xp6(2),t.Q6J("ngForOf",e.entries)}}function ht(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"ul"),t.YNc(2,it,7,2,"li",4),t.qZA(),t.TgZ(3,"ul")(4,"li",5)(5,"input",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().saveModifications()}),t.qZA(),t.TgZ(6,"input",7),t.NdJ("click",function(){return t.CHM(e),t.oxw().openOutside(!0)}),t.qZA(),t.TgZ(7,"input",8),t.NdJ("click",function(){return t.CHM(e),t.oxw().openOutside(!1)}),t.qZA()()(),t.TgZ(8,"div",9)(9,"ul",10),t.YNc(10,rt,4,7,"ng-container",11),t.TgZ(11,"li")(12,"h1",12)(13,"input",13),t.NdJ("click",function(){return t.CHM(e),t.oxw().addCategory()}),t.qZA()()()(),t.TgZ(14,"div",14)(15,"ul",15)(16,"li",16)(17,"p",17),t._uU(18," <- Select a category "),t.qZA()(),t.YNc(19,ut,7,5,"ng-container",11),t.qZA()()(),t.TgZ(20,"ul")(21,"li",5)(22,"input",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().saveModifications()}),t.qZA(),t.TgZ(23,"input",7),t.NdJ("click",function(){return t.CHM(e),t.oxw().openOutside(!0)}),t.qZA(),t.TgZ(24,"input",8),t.NdJ("click",function(){return t.CHM(e),t.oxw().openOutside(!1)}),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.dictionaries.length>0),t.xp6(3),t.Q6J("disabled",e.saving),t.xp6(5),t.Q6J("ngForOf",e.categories),t.xp6(6),t.Q6J("ngClass",t.VKq(6,b,e.selectOpenCategory>=0)),t.xp6(3),t.Q6J("ngForOf",e.categories),t.xp6(3),t.Q6J("disabled",e.saving)}}let T=(()=>{class o extends et{constructor(e,n){super(e),this.api=e,this.route=n,this.Sidebar2Chapter=new t.vpe,this.dictionaries=[],this.categories=[],this.dictionarySelector="",this.shortcuts=[],this.selectOpenCategory=-1,this.selectedEntry=-1,this.getSelectedEntryType=i=>{let r=i.split("-");return r[3]?"-"+r[3]:""},this.moveFocus=(i,r)=>{let c=document.getElementById(i);c?(c.focus(),c.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})):console.error(i)},this.moveCurrentCategory=i=>{this.moveFocus("category-"+this.selectOpenCategory,i)},this.moveCurrentEntry=(i="",r)=>{this.moveFocus("entry-"+this.selectOpenCategory+"-"+this.selectedEntry+i,r)},this.saving=!1}ngOnInit(){this.idNovel=this.route.snapshot.params.idNovel,this.api.Dictionary.getAll({idNovel:this.idNovel}).then(e=>{this.dictionaries=e,this.dictionarySelector=e[0].id,this.dictionarySelected(this.dictionarySelector)})}changeEntryTarget(e,n,i,r){if(r){const c=r.id.split("-");if("entry"==c[0])switch(c[3]){case"sufix":e.sufix=parseInt(r.value);break;case"prefix":e.prefix=parseInt(r.value);break;case"desc":e.description=r.value;break;case"trans":e.entryTranslation=r.value;break;default:e.entryOriginal=r.value}}this.changeEntry(e,n,i)}ngOnDestroy(){delete this.dictionaries,delete this.categories,delete this.categoriesOriginalValues,delete this.idCategory,delete this.idDictionary,delete this.idNovel,delete this.dictionarySelector,console.log("destroy Sidebar")}dictionarySelected(e){this.idDictionary=e,this.getCache()}getCache(){0===this.categories.length?this.api.Dictionary.getCache(this.idDictionary).then(e=>{this.PrepareCacheThenTranslate(e)}):this.refreshTranslation()}PrepareCacheThenTranslate(e){e&&new Promise((i,r)=>{this.rebuildCache(i)}).then(i=>{this.refreshTranslation()})}refreshTranslation(){this.Sidebar2Chapter.emit(this.categories)}refreshOriginal(){this.Sidebar2Chapter.emit([])}saveModifications(){this.saving=!0,this.api.Dictionary.fullSave(this.idDictionary,this.categories).then(e=>{this.categories=[],this.getCache(),this.refreshTranslation(),this.saving=!1}).catch(e=>{this.saving=!1,console.error(e)})}openOutside(e){let i=`${v.N.backendServer}/static/${this.idNovel}/${this.idDictionary}/${this.route.snapshot.params.noChapter}/`;e&&(i="https://translate.google.com/translate?sl=auto&tl=en&u="+i),window.open(i)}textPointer(e,n){this.selectOpenCategory=e,this.selectedEntry=n,setTimeout(()=>{this.moveCurrentEntry("")},100)}activateSufix(e,n,i){switch(!0){case!!e.sufix:e.sufix=null,e.prefix=this.categories[0].id;break;case!!e.prefix:e.sufix=null,e.prefix=null;break;default:e.sufix=this.categories[0].id,e.prefix=null}this.changeEntry(e,n,i)}ngAfterViewInit(){this.shortcuts.push({key:["f5"],preventDefault:!0,label:"Dictionary",description:"Refresh Translation",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{this.refreshTranslation()}},{key:["f4"],preventDefault:!0,label:"Dictionary",description:"Refresh to Original",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{this.refreshOriginal()}},{key:["ctrl + s"],preventDefault:!0,label:"Dictionary",description:"Save Modifications",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{this.saveModifications()}},{key:["ctrl + up","ctrl + alt + up"],preventDefault:!0,label:"Categories",description:"Category Up",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{this.selectedEntry=-1,this.selectOpenCategory>0?this.selectOpenCategory--:this.selectOpenCategory=this.categories.length-1,this.moveCurrentCategory(e)}},{key:["ctrl + down","ctrl + alt + down"],preventDefault:!0,label:"Categories",description:"Category Down",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{this.selectedEntry=-1,this.selectOpenCategory<this.categories.length-1?this.selectOpenCategory++:this.selectOpenCategory=0,this.moveCurrentCategory(e)}},{key:["ctrl + alt + plus","ctrl + alt + n"],preventDefault:!0,label:"Categories",description:"Add New Category",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{this.addCategory(),this.selectOpenCategory=this.categories.length-1,setTimeout(()=>{this.moveCurrentCategory(e)},100)}},{key:"alt + down",preventDefault:!0,label:"Entries",description:"Move Down on Entry List",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{if(this.selectOpenCategory<0&&(this.selectOpenCategory=0),this.categories[this.selectOpenCategory].entries){this.selectedEntry>=this.categories[this.selectOpenCategory].entries.length-1?this.selectedEntry=0:this.selectedEntry++;let n=e.event.target,i=n.id?this.getSelectedEntryType(n.id):"";("-sufix"==i&&!this.categories[this.selectOpenCategory].entries[this.selectedEntry].sufix||"-prefix"==i&&!this.categories[this.selectOpenCategory].entries[this.selectedEntry].prefix)&&(i="-trans"),this.moveCurrentEntry(i,e)}}},{key:"alt + up",preventDefault:!0,label:"Entries",description:"Move Up on Entry List",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{if(this.selectOpenCategory<0&&(this.selectOpenCategory=0),this.categories[this.selectOpenCategory].entries){this.selectedEntry<=0?this.selectedEntry=this.categories[this.selectOpenCategory].entries.length-1:this.selectedEntry--;let n=e.event.target,i=n.id?this.getSelectedEntryType(n.id):"";("-sufix"==i&&!this.categories[this.selectOpenCategory].entries[this.selectedEntry].sufix||"-prefix"==i&&!this.categories[this.selectOpenCategory].entries[this.selectedEntry].prefix)&&(i="-trans"),this.moveCurrentEntry(i,e)}}},{key:"alt + right",preventDefault:!0,label:"Entries",description:"Move Right on Entry List",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{if(this.selectOpenCategory<0||!this.categories[this.selectOpenCategory].entries)return;let n=e.event.target;if(0!==n.id.indexOf("entry-"))return;let i=n.id?this.getSelectedEntryType(n.id):"";switch(i){case"":i=this.categories[this.selectOpenCategory].entries[this.selectedEntry].sufix?"-sufix":"-trans";break;case"-sufix":i="-trans";break;case"-trans":i=this.categories[this.selectOpenCategory].entries[this.selectedEntry].prefix?"-prefix":"-desc";break;case"-prefix":i="-desc"}this.moveCurrentEntry(i,e)}},{key:"alt + left",preventDefault:!0,label:"Entries",description:"Move Left on Entry List",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{if(this.selectOpenCategory<0||!this.categories[this.selectOpenCategory].entries)return;let n=e.event.target;if(0!==n.id.indexOf("entry-"))return;let i=n.id?this.getSelectedEntryType(n.id):"";switch(i){case"-desc":i=this.categories[this.selectOpenCategory].entries[this.selectedEntry].prefix?"-prefix":"-trans";break;case"-prefix":i="-trans";break;case"-trans":i=this.categories[this.selectOpenCategory].entries[this.selectedEntry].sufix?"-sufix":"";break;case"-sufix":i=""}this.moveCurrentEntry(i,e)}},{key:["alt + home","alt + 1"],preventDefault:!0,label:"Entries",description:"Move to First Entry",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{if(this.selectOpenCategory<0&&(this.selectOpenCategory=0),this.categories[this.selectOpenCategory].entries){this.selectedEntry=0;let n=e.event.target,i=n.id?this.getSelectedEntryType(n.id):"";this.moveCurrentEntry(i,e)}}},{key:"alt + end",preventDefault:!0,label:"Entries",description:"Move to Last Entry",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{if(this.selectOpenCategory<0&&(this.selectOpenCategory=0),this.categories[this.selectOpenCategory].entries){this.selectedEntry=this.categories[this.selectOpenCategory].entries.length-1;let n=e.event.target,i=n.id?this.getSelectedEntryType(n.id):"";this.moveCurrentEntry(i,e)}}},{key:["alt + plus","alt + insert","alt + n"],preventDefault:!0,label:"Entries",description:"Add New Entry",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{this.selectOpenCategory<0||(this.addEntry(this.categories[this.selectOpenCategory],this.categories[this.selectOpenCategory].id,this.selectOpenCategory),this.selectedEntry=this.categories[this.selectOpenCategory].entries.length-1,setTimeout(()=>{this.moveCurrentEntry("",e)},100))}},{key:["ctrl + d","alt + d"],preventDefault:!0,label:"Entries",description:"Duplicate Entry",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{this.selectOpenCategory<0||this.selectedEntry<0||this.duplicateEntry(this.categories[this.selectOpenCategory],this.categories[this.selectOpenCategory].id,this.selectOpenCategory,this.categories[this.selectOpenCategory].entries[this.selectedEntry])}},{key:["alt + -","alt + d"],preventDefault:!0,label:"Entries",description:"Remove Entry",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{if(this.selectOpenCategory<0||this.selectedEntry<0)return;let n=this.categories[this.selectOpenCategory].entries[this.selectedEntry];n.delete=!n.delete}},{key:["alt + *","alt + r"],preventDefault:!0,label:"Entries",description:"Return Entry to normal",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{if(this.selectOpenCategory<0||this.selectedEntry<0)return;let n=this.categories[this.selectOpenCategory].entries[this.selectedEntry];n.reset=!0,this.changeEntry(n,this.selectOpenCategory,this.selectedEntry),setTimeout(()=>{this.moveFocus(e.event.target.id)},100)}},{key:["alt + s"],preventDefault:!0,label:"Entries",description:"Toggle Suffix/Prefix",allowIn:[s.Mv.ContentEditable,s.Mv.Input,s.Mv.Select,s.Mv.Textarea],command:e=>{this.selectOpenCategory<0||this.selectedEntry<0||this.activateSufix(this.categories[this.selectOpenCategory].entries[this.selectedEntry],this.selectOpenCategory,this.selectedEntry)}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(C.s),t.Y36(p.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-chapter-sidebar"]],viewQuery:function(e,n){if(1&e&&t.Gf(s.xj,5),2&e){let i;t.iGM(i=t.CRH())&&(n.keyboard=i.first)}},outputs:{Sidebar2Chapter:"Sidebar2Chapter"},features:[t.qOj],decls:3,vars:4,consts:[["class","dictionaryList",4,"ngIf"],[3,"shortcuts"],[3,"key","title"],[1,"dictionaryList"],["class","dictionary-selector",4,"ngIf"],[1,"dictionary-buttons"],["type","button","value","Save Modifications",1,"button","is-small","is-danger",3,"disabled","click"],["type","button","value","Google Translate",1,"button","is-small","is-info",3,"click"],["type","button","value","Open Keyword Translated Raw",1,"button","is-small","is-warning",3,"click"],[1,"interactiveBox"],[1,"categories"],[4,"ngFor","ngForOf"],[1,"categoryButtonRow"],["type","button","value","+ Add new Category",1,"button","is-small","is-primary",3,"click"],[1,"entries"],[1,"entries-container"],[3,"ngClass"],[1,"hint"],[1,"dictionary-selector"],["type","button","value","Refresh Translation",1,"button","is-small","is-info",3,"click"],["type","button","value","Refresh to Original",1,"button","is-small","is-warning",3,"click"],[1,"select",3,"ngModel","ngModelChange","change"],["value","","selected","selected"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"ngClass","click"],["type","text","placeholder","Category Name",1,"category-name",3,"ngModel","id","ngModelChange"],[1,"category-entry-container",3,"id"],["categoryDOM",""],["class","entry",3,"ngClass",4,"ngFor","ngForOf"],[1,"entry-spacer"],["type","button","value","+ Add new Entry",1,"addNewEntryButton",3,"click"],[1,"entry",3,"ngClass"],["type","text","placeholder","Original",1,"entry-original",3,"ngModel","id","ngModelChange","focus"],["entry",""],[1,"sufixButton","sidebarButton"],["type","checkbox","title","Toggle suffix/prefix on/off",1,"hidden",3,"ngModel","ngModelChange","change"],["class","select",3,"ngModel","id","ngModelChange","change",4,"ngIf"],["type","text","placeholder","Translation",3,"ngClass","ngModel","id","ngModelChange","focus"],["type","text","placeholder","Description",1,"entry-description",3,"ngModel","id","ngModelChange","focus"],[1,"deleteButton","sidebarButton"],[1,"fas","fa-trash"],["type","checkbox","title","Delete",1,"hidden",3,"change"],[1,"resetButton","sidebarButton"],[1,"fas","fa-sync-alt"],["type","checkbox","title","Reset",1,"hidden",3,"change"],[1,"select",3,"ngModel","id","ngModelChange","change"],["disabled","disabled"]],template:function(e,n){1&e&&(t.YNc(0,ht,25,8,"div",0),t._UZ(1,"ng-keyboard-shortcuts",1)(2,"ng-keyboard-shortcuts-help",2)),2&e&&(t.Q6J("ngIf",n.dictionaries.length>0),t.xp6(1),t.Q6J("shortcuts",n.shortcuts),t.xp6(1),t.Q6J("key","f1")("title","Shortcut Keys"))},directives:[d.O5,u.EJ,u.JJ,u.On,u.YN,u.Kr,d.sg,d.mk,u.Fj,u.Wl,s.xj,s.iD],styles:['.dictionaryList[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;overflow-y:hidden}.dictionaryList[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%]{flex-grow:0;flex-basis:25px;height:30px}.dictionaryList[_ngcontent-%COMP%]   .dictionary-selector[_ngcontent-%COMP%]{align-self:flex-start;width:100%}.dictionaryList[_ngcontent-%COMP%]   .dictionary-selector[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:33.3%;height:100%}.dictionaryList[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{align-self:flex-end}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]{display:flex;flex-direction:row;overflow-y:hidden;flex-grow:1;flex-basis:auto}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]{color:#fff;background:rgba(255,255,255,.5);float:left;line-height:1.4;animation-duration:.05s;animation-name:categoriesHide;width:50px}@keyframes categoriesShow{0%{width:50px}to{width:150px}}@keyframes categoriesHide{0%{width:150px}to{width:50px}}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]:hover{animation-duration:.05s;animation-name:categoriesShow;width:150px}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{height:30px;width:100%;background:#2f0050}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   h1.changed[_ngcontent-%COMP%]{background:#009013}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   h1.new[_ngcontent-%COMP%]{background:#000063}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   h1.categoryButtonRow[_ngcontent-%COMP%]{background:#00d1b2}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   h1.categoryButtonRow[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:transparent}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{background-color:transparent;border:0px solid white;color:#fff;outline-width:0px}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   .category-selected[_ngcontent-%COMP%]{border-width:2px 0px 2px 5px;border-style:solid;border-color:red}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]{width:100%;height:100%;padding:left 10;float:left;overflow:hidden;z-index:1;background-color:#5e009f}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{background:black;color:#fff;height:100%}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]{height:100%}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{height:100%;position:relative;overflow-x:auto}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]{flex-direction:row;overflow-y:auto;overflow-x:hidden;height:100%;height:calc(100% - 30px);width:100%}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{box-sizing:border-box}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]{width:100%;min-width:630px;height:25px;display:flex;flex-direction:row}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus{background-color:#ffffff4d!important}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:transparent;border:0px solid white;color:#fff}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .entry-original[_ngcontent-%COMP%], .dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .entry-translation[_ngcontent-%COMP%], .dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .sidebarButton[_ngcontent-%COMP%], .dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]{flex-grow:0}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .entry-original[_ngcontent-%COMP%]{flex-basis:100px}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .entry-translation[_ngcontent-%COMP%], .dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .entry-translation-half[_ngcontent-%COMP%]{min-width:30px}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .entry-translation[_ngcontent-%COMP%]{flex-basis:150px}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .entry-translation-half[_ngcontent-%COMP%]{flex-basis:75px}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .entry-description[_ngcontent-%COMP%]{flex-grow:1}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]{flex-basis:75px;max-width:75px;color:#fff;background-color:#000;outline:0px solid #000;border:0px solid #000;height:100%}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]:focus{outline:1px solid blue}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .sufixButton[_ngcontent-%COMP%]{color:pink}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .deleteButton[_ngcontent-%COMP%]{color:red}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .resetButton[_ngcontent-%COMP%]{color:#00f}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]   .sidebarButton[_ngcontent-%COMP%]{flex-basis:14px;margin:0 8px;text-align:center}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]:after{clear:both;content:"";display:block}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]:nth-child(odd){background-color:#555}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]:nth-child(even){background-color:#888}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry.changed[_ngcontent-%COMP%]{background-color:green}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry.new[_ngcontent-%COMP%]{background-color:#000063}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]   .entry.deleted[_ngcontent-%COMP%]{background-color:#480000}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry-spacer[_ngcontent-%COMP%]{height:200px}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .addNewEntryButton[_ngcontent-%COMP%]{position:absolute;bottom:0px;left:0px;width:100%;height:30px;text-align:left;border-width:2px 0;border-color:#009013;background-color:#000;color:#fff}.dictionaryList[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{display:none}.dictionaryList[_ngcontent-%COMP%]   .dictionary-buttons[_ngcontent-%COMP%]{width:100%}.dictionaryList[_ngcontent-%COMP%]   .dictionary-buttons[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:33.3%;height:100%}']}),o})();var w=g(1481);function Ct(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"a",15),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).chapterRoute.previous()}),t._uU(1," Previous "),t.qZA()}}function ft(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"a",15),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).chapterRoute.next()}),t._uU(1," Next "),t.qZA()}}const xt=function(o){return["/novel/",o]};function yt(o,a){if(1&o&&(t.TgZ(0,"div",11)(1,"div",12),t.YNc(2,Ct,2,0,"a",13),t.qZA(),t.TgZ(3,"div",12)(4,"a",14),t._uU(5," Table of Contents "),t.qZA()(),t.TgZ(6,"div",12),t.YNc(7,ft,2,0,"a",13),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.chapterPrevious),t.xp6(2),t.Q6J("routerLink",t.VKq(3,xt,e.idNovel)),t.xp6(3),t.Q6J("ngIf",e.chapterNext)}}function Mt(o,a){1&o&&t.GkF(0)}function Ot(o,a){if(1&o&&(t.TgZ(0,"h2"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.chapter.arc)}}function mt(o,a){if(1&o&&(t.ynx(0),t.YNc(1,Ot,2,1,"h2",8),t._UZ(2,"h1",16),t.ALo(3,"safeHtml"),t._UZ(4,"hr")(5,"div",17),t.ALo(6,"safeHtml"),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.chapter.arc),t.xp6(1),t.Q6J("innerHTML",t.lcZ(3,3,e.renderedTitle),t.oJD),t.xp6(3),t.Q6J("innerHTML",t.lcZ(6,5,e.renderedText),t.oJD)}}function vt(o,a){1&o&&t.GkF(0)}let Pt=(()=>{class o{constructor(e){this.sanitized=e}transform(e){return this.sanitized.bypassSecurityTrustHtml(e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(w.H7,16))},o.\u0275pipe=t.Yjl({name:"safeHtml",type:o,pure:!0}),o})(),Z=(()=>{class o{constructor(e,n,i,r,c){this.router=e,this.route=n,this.sanitized=i,this.api=r,this.viewport=c,this.shortcuts=[],this.chapterRoute={next:()=>{document.getElementById("content").scrollTop=0,this.router.navigate(["novel",this.idNovel,this.chapterNext.no])},previous:()=>{document.getElementById("content").scrollTop=0,this.router.navigate(["novel",this.idNovel,this.chapterPrevious.no])}},this.showSidebar=!0,this.translateWorker=new Worker(g.tu(new URL(g.p+g.u(250),g.b)),{type:void 0})}ngOnInit(){this.loadedChapter=new Promise(e=>{this.loadedChapterResolve=e}),this.startContent()}ngAfterViewInit(){this.shortcuts.push({key:"alt + pageup",preventDefault:!0,label:"Chapter",description:"Previous Chapter",command:e=>{this.chapterRoute.previous()}},{key:"alt + pagedown",preventDefault:!0,label:"Chapter",description:"Next Chapter",command:e=>{this.chapterRoute.next()}})}ngOnDestroy(){delete this.loadedChapter,console.log("destroy detailed chapter")}ngDoCheck(){this.noChapter!==this.route.snapshot.params.noChapter&&(console.log("changing chapter",this.Sidebar.categories),this.ngOnInit(),this.translateText(this.Sidebar.categories))}startContent(){this.idNovel=this.route.snapshot.params.idNovel,this.noChapter=this.route.snapshot.params.noChapter,Promise.all([this.api.Novel.get({id:this.idNovel}),this.api.Chapter.get({idNovel:this.idNovel,no:this.noChapter,text:!0})]).then(e=>{this.novel=e[0],this.chapter=e[1],this.renderDataView(),this.cacheAdjecentChapters(this.noChapter-0),this.loadedChapterResolve()})}cacheAdjecentChapters(e){const n=e-1;n>0&&this.api.Chapter.get({idNovel:this.idNovel,no:n,text:!0}).then(r=>{this.chapterPrevious=r});const i=e-0+1;i<=this.novel.numberChapters&&this.api.Chapter.get({idNovel:this.idNovel,no:i,text:!0}).then(r=>{this.chapterNext=r})}renderDataView(){this.renderedTitle=this.chapter.title,this.renderedText=this.chapter.textRevision?this.chapter.textRevision:this.chapter.textOriginal}translateText(e){this.loadedChapter.then(n=>{typeof Worker<"u"?(this.translateWorker.onmessage=i=>{this.renderedText=i.data.text,this.renderedTitle=i.data.title,setTimeout(()=>{Array.from(document.getElementsByClassName("replaced")).forEach(c=>{c.addEventListener("click",l=>{let _=l.target.id.split("-");this.Sidebar.textPointer(_[1],_[2])})})},200)},this.translateWorker.postMessage({categories:e,title:this.chapter.title,text:this.chapter.textRevision?this.chapter.textRevision:this.chapter.textOriginal})):console.log("use some browser, goddamnit")})}toogleSidebar(){this.showSidebar=!this.showSidebar}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.F0),t.Y36(p.gz),t.Y36(w.H7),t.Y36(C.s),t.Y36(d.EM))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-chapter-detail"]],viewQuery:function(e,n){if(1&e&&(t.Gf(T,5),t.Gf(s.xj,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.Sidebar=i.first),t.iGM(i=t.CRH())&&(n.keyboard=i.first)}},decls:13,vars:7,consts:[[1,"flexContent"],[1,"sidebar",3,"hidden"],[3,"Sidebar2Chapter"],["SidebarChild",""],["id","content",1,"content"],["Content",""],["controlButtons",""],[4,"ngTemplateOutlet"],[4,"ngIf"],[3,"shortcuts"],[3,"key","title"],[1,"columns","controlButtons"],[1,"column"],["class","button is-large is-primary",3,"click",4,"ngIf"],[1,"button","is-large","is-primary",3,"routerLink"],[1,"button","is-large","is-primary",3,"click"],[1,"title",3,"innerHTML"],[1,"novel-content",3,"innerHTML"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"app-chapter-sidebar",2,3),t.NdJ("Sidebar2Chapter",function(r){return n.translateText(r)}),t.qZA()(),t.TgZ(4,"div",4,5),t.YNc(6,yt,8,5,"ng-template",null,6,t.W1O),t.YNc(8,Mt,1,0,"ng-container",7),t.YNc(9,mt,7,7,"ng-container",8),t.YNc(10,vt,1,0,"ng-container",7),t.qZA()(),t._UZ(11,"ng-keyboard-shortcuts",9)(12,"ng-keyboard-shortcuts-help",10)),2&e){const i=t.MAs(7);t.xp6(1),t.Q6J("hidden",!n.showSidebar),t.xp6(7),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("ngIf",n.chapter),t.xp6(1),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("shortcuts",n.shortcuts),t.xp6(1),t.Q6J("key","f1")("title","Help")}},styles:[".controlButtons{margin-top:1px}.controlButtons a{width:100%;text-align:center}.content>h1.title{color:#fff}.novel-content{color:#fff}.novel-content .replaced{background-color:#636363}.novel-content .replaced.sufix{background-color:#ce7474}.novel-content .replaced.prefix{background-color:#7476ce}.flexContent{display:flex;flex-direction:row;width:100%;height:100%}.flexContent .sidebar{z-index:20;width:400px;position:fixed;left:0px;margin-right:10px;height:calc(100% - 100px);top:100px;bottom:0px;overflow-y:auto;background:#5e009f}.flexContent .sidebar:hover{width:80%;max-width:800px}.flexContent .content{width:calc(100% - 410px);height:calc(100% - 100px);right:0px;position:fixed;overflow-y:auto;overflow-x:hidden}.help-modal__body{min-width:700px;color:#000}\n"],encapsulation:2}),o})();const bt=[{path:"",component:X,data:{title:"List Chapters"}},{path:"dictionary",loadChildren:()=>g.e(256).then(g.bind(g,8256)).then(o=>o.DictionaryModule),data:{title:"View dictionary",breadcrumb:"Dictionaries"}},{path:":noChapter",component:Z,data:{title:"View chapter",breadcrumb:"View Chapter"}},{path:"**",redirectTo:""}];let Tt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[p.Bz.forChild(bt)],p.Bz]}),o})(),wt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[d.ez,Tt,p.Bz,u.u5,s.Ux.forRoot()]]}),o})();t.B6R(Z,[T,d.O5,p.yS,d.tP,s.xj,s.iD],[Pt])}}]);