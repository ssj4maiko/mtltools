{"version":3,"file":"src_app_chapter_index_ts.js","mappings":"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","sources":["./src/app/chapter/chapter-routing.module.ts","./src/app/chapter/chapter.module.ts","./src/app/chapter/detail/detail.component.ts","./src/app/chapter/detail/detail.component.html","./src/app/chapter/form.service.ts","./src/app/chapter/index.ts","./src/app/chapter/list/list.component.ts","./src/app/chapter/list/list.component.html","./src/app/chapter/sidebar/sidebar.component.ts","./src/app/chapter/sidebar/sidebar.component.html"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ListComponent } from './list/list.component';\nimport { DetailComponent } from './detail/detail.component';\n\nconst routes: Routes = [\n  {\n     path: ''\n    , component: ListComponent\n    , data: { title: 'List Chapters' }\n  },\n  {\n    path: 'dictionary'\n    , loadChildren: () => import('../dictionary').then(m => m.DictionaryModule)\n    , data: { title: 'View dictionary', breadcrumb: 'Dictionaries' }\n  },\n  {\n     path: ':noChapter'\n    , component: DetailComponent\n    // ,loadChildren: () => ChapterModule\n    , data: { title: 'View chapter', breadcrumb: 'View Chapter' }\n  },\n  {\n     path: '**'\n    , redirectTo: ''\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class ChapterRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\n\nimport { ChapterRoutingModule } from './chapter-routing.module';\n\nimport { ListComponent } from './list/list.component';\nimport { DetailComponent } from './detail/detail.component';\nimport { SidebarComponent } from './sidebar/sidebar.component';\nimport { FormsModule } from '@angular/forms';\n\n@NgModule({\n\tdeclarations: [\n\t\tListComponent,\n\t\tDetailComponent,\n\t\tSidebarComponent,\n\t],\n\timports: [\n\t\tCommonModule,\n\t\tChapterRoutingModule,\n        RouterModule,\n        FormsModule\n\t]\n})\nexport class ChapterModule { }\n","import { Component, OnInit, ViewChild } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { ApiService } from '../../api';\nimport { DomSanitizer } from '@angular/platform-browser';\n\nimport { Chapter } from '../../_models/chapter';\nimport { Novel } from '../../_models/novel';\nimport { DictionaryCategory } from 'src/app/_models/dictionarycategory';\nimport { CategoryModule } from 'src/app/category';\nimport { count } from 'rxjs-compat/operator/count';\nimport { SidebarComponent } from '../sidebar/sidebar.component';\n\n@Component({\n  selector: 'app-chapter-detail',\n  templateUrl: './detail.component.html',\n  styleUrls: ['./detail.component.scss']\n})\nexport class DetailComponent implements OnInit {\n  @ViewChild(SidebarComponent) Sidebar;\n\n  chapter: Chapter;\n  novel: Novel;\n  idNovel: number;\n  noChapter: number;\n\n  chapterPrevious: Chapter;\n  chapterNext: Chapter;\n\n  renderedTitle: string;\n  renderedText: string;\n  loadedChapter: Promise<void>;\n  loadedChapterResolve: () => void;\n\n\n  showSidebar: boolean;\n\n  constructor(\n    private router: Router,\n    private route: ActivatedRoute,\n    public sanitized: DomSanitizer,\n    private api: ApiService\n  ) {\n    this.showSidebar = true;\n  }\n\n  ngOnInit() {\n    this.loadedChapter = new Promise<void>((resolve) => {\n      this.loadedChapterResolve = resolve;\n    });\n    this.startContent();\n  }\n  ngOnDestroy() {\n    delete this.loadedChapter;\n    console.log('destroy detailed chapter');\n  }\n  ngDoCheck() {\n\n    if (this.noChapter !== this.route.snapshot.params.noChapter) {\n      console.log('changing chapter', this.Sidebar.categories);\n      this.ngOnInit();\n      this.translateText(this.Sidebar.categories);\n    }\n  }\n\n  private startContent() {\n    this.idNovel = this.route.snapshot.params.idNovel;\n    this.noChapter = this.route.snapshot.params.noChapter;\n    Promise.all([\n      this.api.Novel.get({ id: this.idNovel }),\n      this.api.Chapter.get({ idNovel: this.idNovel, no: this.noChapter, text: true })\n    ]).then((values: [Novel, Chapter]) => {\n      this.novel = values[0];\n      this.chapter = values[1];\n\n      this.renderDataView();\n      this.cacheAdjecentChapters(this.noChapter - 0);\n      this.loadedChapterResolve();\n    });\n  }\n  private cacheAdjecentChapters(noChapter: number) {\n    const prev = noChapter - 1;\n    if (prev > 0) {\n      this.api.Chapter.get({ idNovel: this.idNovel, no: prev, text: true })\n        .then(previous => {\n          this.chapterPrevious = previous;\n        });\n    }\n    const next = noChapter - 0 + 1;\n    if (next <= this.novel.numberChapters) {\n      this.api.Chapter.get({ idNovel: this.idNovel, no: next, text: true })\n        .then(Next => {\n          this.chapterNext = Next;\n        });\n    }\n  }\n  renderDataView() {\n    this.renderedTitle = this.chapter.title;\n    this.renderedText = !!this.chapter.textRevision ? this.chapter.textRevision : this.chapter.textOriginal;\n  }\n\n  translateText(categories: DictionaryCategory[]) {\n    // In case the dictionary comes first, then let it wait for the chapter\n    this.loadedChapter.then(_ => {\n      this.renderDataView();\n      if (categories.length > 0) {\n        const entries = [];\n        categories.forEach(category => {\n          category.entries.forEach(entry => {\n            const length = entry.entryOriginal.length;\n            if (!entries[length]) {\n              entries[length] = [];\n            }\n            entries[length].push({\n              entryOriginal: entry.entryOriginal,\n              entryTranslation: entry.entryTranslation,\n              idEntry: entry.id,\n              idCategory: category.id,\n              category: category.name,\n            });\n          });\n        });\n        for (let i = entries.length; i > 0; --i) {\n          if (entries[i]) {\n            entries[i].forEach(entry => {\n              // console.log('Change ', entry.entryOriginal, entry.entryTranslation);\n              const regex = new RegExp(entry.entryOriginal, 'g');\n              this.renderedTitle = this.renderedTitle.replace(regex, '\\[\\[' + entry.entryTranslation + '\\]\\]');\n              this.renderedText = this.renderedText.replace(regex, '\\[\\[' + entry.entryTranslation + '\\]\\]');\n            });\n          }\n        }\n        // The extra characters are to allow to create a space in between translated words\n        let regex = new RegExp('\\\\]\\\\]\\\\[\\\\[', 'g');\n        this.renderedTitle = this.renderedTitle.replace(regex, ' ');\n        this.renderedText = this.renderedText.replace(regex, ' ');\n        regex = new RegExp('\\\\]\\\\]', 'g');\n        this.renderedTitle = this.renderedTitle.replace(regex, '');\n        this.renderedText = this.renderedText.replace(regex, '');\n        regex = new RegExp('\\\\[\\\\[', 'g');\n        this.renderedTitle = this.renderedTitle.replace(regex, '');\n        this.renderedText = this.renderedText.replace(regex, '');\n      }\n    });\n\n  }\n  toogleSidebar() {\n    if (this.showSidebar)\n      this.showSidebar = false;\n    else\n      this.showSidebar = true;\n  }\n\n}\n","<div class='flexContent'>\n\t<div class='content'>\n\t\t<ng-template #controlButtons>\n\t\t\t<div class=\"columns controlButtons\">\n\t\t\t\t<div class=\"column\">\n\t\t\t\t\t<a class=\"button is-large is-primary\" *ngIf=\"chapterPrevious\" [routerLink]=\"['/novel/', idNovel, chapterPrevious.no]\"> Previous </a>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"column\">\n\t\t\t\t\t<a class=\"button is-large is-primary\" [routerLink]=\"['/novel/', idNovel]\"> Table of Contents </a>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"column\">\n\t\t\t\t\t<a class=\"button is-large is-primary\" *ngIf=\"chapterNext\" [routerLink]=\"['/novel/', idNovel, chapterNext.no]\"> Next </a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</ng-template>\n\n\t\t<ng-container *ngTemplateOutlet=\"controlButtons\"></ng-container>\n\t\t<ng-container *ngIf=\"chapter\">\n\t\t\t<h1 class='title'>{{ this.renderedTitle }}</h1>\n\t\t\t<hr />\n\t\t\t<div class=\"novel-content\" innerHTML=\"{{ this.renderedText }}\">\n\n\t\t\t</div>\n\t\t</ng-container>\n\t\t<ng-container *ngTemplateOutlet=\"controlButtons\"></ng-container>\n\t</div>\n\n\t<div class=\"show-sidebar\" (click)=\"toogleSidebar()\">AHHHHHHH</div>\n\t<div class=\"sidebar\" [hidden]=\"!showSidebar\">\n\t\t<app-chapter-sidebar (Sidebar2Chapter)=\"translateText($event)\"></app-chapter-sidebar>\n\t</div>\n</div>","import { Injectable } from '@angular/core';\nimport { FormArray, FormBuilder, FormControl, FormGroup } from '@angular/forms';\nimport { ApiService } from '../api';\nimport { DictionaryCategory, DictionaryEntry, EntryForm } from '../_models';\nimport { Dictionary } from '../_models/dictionary';\nimport { FormField, Meta, Option } from '../_models/formField';\nimport { Novel } from '../_models/novel';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FormService {\n  idDictionary: number;\n\n  categories: DictionaryCategory[] = [];\n  categoriesOriginalValues: DictionaryCategory[] = [];\n\n  indexes: string[] = [];\n\n  constructor(\n    public api: ApiService\n  ) { }\n\n  rebuildCache(resolveDic): void {\n    this.api.Category.getAll({ idDictionary: this.idDictionary })\n      .then((categories) => {\n\n        this.categories = Object.values(categories);\n        const LoadedPromise = [];\n\n        this.categories.forEach((category, categoryIndex) => {\n          LoadedPromise.push(new Promise<void>((resolveCat, rejectCat) => {\n\n            this.api.Entry.getAll({ idDictionary: this.idDictionary, idCategory: category.id })\n              .then((entries) => {\n                LoadedPromise.push(new Promise<void>((resolveEnt, rejectEnt) => {\n                  /**\n                   * @var DictionaryEntry[] category.entries\n                   */\n                  category.entries = Object.values(entries);\n                  resolveEnt();\n                }));\n              });\n            resolveCat();\n          }));\n        });\n\n        Promise.all(LoadedPromise)\n          .then(_ => {\n            this.categoriesOriginalValues = JSON.parse(JSON.stringify(this.categories));\n            resolveDic();\n          });\n      });\n  }\n  addEntry(category) {\n    if (!category.entries) {\n      category.entries = [];\n    }\n    category.entries.push(new EntryForm());\n  }\n  addCategory() {\n    this.categories.push(new DictionaryCategory(null, this.idDictionary));\n  }\n\n\n  changeEntry(entry: EntryForm, catIdx?: number, entIdx?: number) {\n    if (entry.reset) {\n      if (this.categories[catIdx].entries[entIdx].id) {\n        this.categories[catIdx].entries[entIdx] = new EntryForm(this.categoriesOriginalValues[catIdx].entries[entIdx]);\n      } else {\n        this.categories[catIdx].entries[entIdx] = new EntryForm(null, this.categories[catIdx].id);\n      }\n    } else {\n      if (entry.delete) {\n        if (!entry.id) {\n          this.categories[catIdx].entries.splice(entIdx, 1);\n        }\n      } else {\n        if (entry.id) {\n          entry.update = entry.entryOriginal    !== this.categoriesOriginalValues[catIdx].entries[entIdx].entryOriginal\n                      || entry.entryTranslation !== this.categoriesOriginalValues[catIdx].entries[entIdx].entryTranslation\n                      || entry.description      !== this.categoriesOriginalValues[catIdx].entries[entIdx].description\n                      || entry.idCategory       !== this.categoriesOriginalValues[catIdx].entries[entIdx].idCategory\n            ;\n        }\n      }\n    }\n  }\n  changeCategory(category, idx) {\n    if (category.id) {\n      category.update = category.name !== this.categoriesOriginalValues[idx].name;\n    }\n  }\n\n}\n","export * from './chapter.module';","import { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { ApiService } from '../../api';\n\nimport { Chapter } from '../../_models/chapter';\nimport { Novel } from '../../_models/novel';\nimport { environment } from 'src/environments/environment';\nimport { Dictionary } from 'src/app/_models/dictionary';\n\n@Component({\n  selector: 'app-chapter-list',\n  templateUrl: './list.component.html',\n  styleUrls: ['./list.component.scss']\n})\nexport class ListComponent implements OnInit {\n\n  chapters: Chapter[] = [];\n  dictionaries: Dictionary[] = [];\n  novel: Novel;\n  idNovel: number;\n\n  constructor(\n      private router: Router\n    , private route: ActivatedRoute\n    , private api: ApiService\n    ) { }\n\n  ngOnInit() {\n    this.idNovel = this.route.snapshot.params.idNovel;\n    this.api.Novel.get({id: this.idNovel})\n                .then(novel => {\n                  this.novel = novel;\n                  this.api.Dictionary.getAll({idNovel: this.idNovel})\n                          .then(dictionaries => {\n                            this.dictionaries = Object.values(dictionaries);\n                            this.api.Chapter.getAll({idNovel: this.idNovel})\n                                            .then(chapters => {\n                                              this.chapters = Object.values(chapters);\n                                            });\n                          });\n                });\n  }\n\n  openGT(chapter: Chapter, dictionary: Dictionary) {\n      let url = `${environment.backendServer}/static/${this.idNovel}/${dictionary.id}/${chapter.no}/1`;\n      url = 'https://translate.google.com/translate?sl=auto&tl=en&u=' + url;\n      window.open(url);\n  }\n\n  updateChapters() {\n    this.api.Chapter.autoUpdate({ idNovel : this.idNovel })\n      .then(res => {\n        /**\n         * Update the list too\n         */\n        this.api.Chapter.getAll({ idNovel: this.idNovel })\n                      .then(chapters => {\n                        this.chapters = Object.values(chapters);\n                      });\n      }, err => {\n        console.log(err);\n      });\n  }\n\n}\n","<ng-template #actionButtons>\n\t<div class=\"columns actionButtons\">\n        <div class=\"column\">\n            <a [routerLink]=\"['/novel/', idNovel,'dictionary']\" class=\"button is-primary\">Dictionary</a>\n        </div>\n\t\t<div class=\"column\" *ngIf=\"novel && novel.driver == 'manual'\">\n\t\t\t<a routerLink=\"['/novel/',idNovel,'add']\" class=\"button is-info\">Import Chapter</a>\n\t\t</div>\n\t\t<div class=\"column\" *ngIf=\"novel && novel.driver != 'manual'\">\n\t\t\t<a (click)=\"updateChapters()\" class=\"button is-info\">Update Chapters</a>\n\t\t</div>\n\t\t<!--div class=\"column\" *ngIf=\"novel && novel.driver == 'syosetu'\">\n\t\t\t<a (click)=\"downloadChapter()\" class=\"button is-info\">Add Next Chapter</a>\n\t\t</div-->\n\t</div>\n</ng-template>\n\n<ng-container *ngTemplateOutlet=\"actionButtons\"></ng-container>\n<div>\n\t<table class='table is-striped is-hoverable is-fullwidth'>\n\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t<th>Number</th>\n\t\t\t\t<th>Title</th>\n\t\t\t\t<th>Date Created</th>\n\t\t\t\t<th>Date Updated</th>\n\t\t\t\t<th>Dictionary<br />Google Translator</th>\n\t\t\t\t<!--th>Actions</th-->\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody>\n\t\t\t<ng-container *ngFor=\"let chapter of chapters\" >\n\t\t\t\t<tr title=\"{{ novel.title }}\">\n\t\t\t\t\t<td>{{ chapter.no }}</td>\n\t\t\t\t\t<td [routerLink]=\"['/novel/', chapter.idNovel, chapter.no]\">{{ chapter.title }}</td>\n\t\t\t\t\t<td [routerLink]=\"['/novel/', chapter.idNovel, chapter.no]\">{{ chapter.dateOriginalPost }}</td>\n\t\t\t\t\t<td [routerLink]=\"['/novel/', chapter.idNovel, chapter.no]\">{{ chapter.dateOriginalRevision }}</td>\n                    <!--td><ng-container *ngIf=\"chapter.hasText == 1; then success else danger\"></ng-container></td-->\n                    <td>\n                        <a *ngFor=\"let dictionary of dictionaries\" (click)=\"openGT(chapter,dictionary);\">{{dictionary.language}}</a>\n                    </td>\n\t\t\t\t\t<!--td>\n\t\t\t\t\t\t<a [routerLink]=\"['/novel/', chapter.idNovel, chapter.no, 'edit']\">UPD</a>\n\t\t\t\t\t\t/\n\t\t\t\t\t\t<a [routerLink]=\"['/novel/', chapter.idNovel, chapter.no, 'del']\">DEL</a>\n\t\t\t\t\t</td-->\n\t\t\t\t\t<ng-template #success>\n\t\t\t\t\t\t<a class='button is-success'>\n\t\t\t\t\t\t\t<span class=\"icon is-small\">\n\t\t\t\t\t\t\t\t<i class=\"fas fa-check\"></i>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</ng-template>\n\t\t\t\t\t<ng-template #danger>\n\t\t\t\t\t\t<a class='button is-danger'>\n\t\t\t\t\t\t\t<span class=\"icon is-small\">\n\t\t\t\t\t\t\t\t<i class=\"fas fa-times\"></i>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</ng-template>\n\t\t\t\t</tr>\n\t\t\t</ng-container>\n\t\t</tbody>\n\t</table>\n</div>\n","import { Component, OnInit, Output, EventEmitter, OnDestroy, ViewChild } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { NgModel } from '@angular/forms';\n\nimport { DictionaryEntry, EntryForm } from '../../_models/dictionaryentry';\nimport { DictionaryCategory } from '../../_models/dictionarycategory';\nimport { Dictionary } from '../../_models/dictionary';\nimport { ApiService } from 'src/app/api';\nimport { environment } from 'src/environments/environment';\nimport { Novel } from 'src/app/_models/novel';\nimport { CacheService } from '../cache.service';\nimport { DetailComponent } from '../detail/detail.component';\nimport { FormService } from '../form.service';\n\n@Component({\n  selector: 'app-chapter-sidebar',\n  templateUrl: './sidebar.component.html',\n  styleUrls: ['./sidebar.component.scss']\n})\nexport class SidebarComponent extends FormService implements OnInit, OnDestroy {\n\n  @Output() Sidebar2Chapter: EventEmitter<DictionaryCategory[]> = new EventEmitter<DictionaryCategory[]>();\n\n  dictionaries: Dictionary[] = [];\n  categories: DictionaryCategory[] = [];\n\n  idCategory: number;\n  idDictionary: number;\n  idNovel: number;\n  novel: Novel;\n\n  dictionarySelector: any = '';\n\n  constructor(\n      public api: ApiService\n    , private route: ActivatedRoute\n  ) {\n    super(api);\n  }\n\n  ngOnInit() {\n    this.idNovel = this.route.snapshot.params.idNovel;\n\n    this.api.Dictionary.getAll({idNovel: this.idNovel})\n      .then((dictionaries: Dictionary[]) => {\n        this.dictionaries = dictionaries;\n        this.dictionarySelector = dictionaries[0].id;\n        this.dictionarySelected(this.dictionarySelector);\n      });\n  }\n  ngOnDestroy() {\n    delete this.dictionaries;\n    delete this.categories;\n    delete this.categoriesOriginalValues;\n    delete this.idCategory;\n    delete this.idDictionary;\n    delete this.idNovel;\n    delete this.dictionarySelector;\n    console.log('destroy Sidebar');\n  }\n  dictionarySelected(idDictionary: number) {\n    this.idDictionary = idDictionary;\n    this.getCache();\n  }\n  private getCache() {\n    if (this.categories.length === 0) {\n      this.api.Dictionary.getCache(this.idDictionary)\n        .then((status) => {\n          this.PrepareCacheThenTranslate(status);\n        });\n    } else {\n      this.refreshTranslation();\n    }\n  }\n  private PrepareCacheThenTranslate(status) {\n    if (status) {\n      const loadedDictionary = new Promise<void>((resolveDic, rejectDic) => {\n        this.rebuildCache(resolveDic);\n      });\n\n      loadedDictionary.then(_ => {\n        this.refreshTranslation();\n      });\n    }\n  }\n\n  refreshTranslation() {\n    this.Sidebar2Chapter.emit(this.categories);\n  }\n  refreshOriginal() {\n    this.Sidebar2Chapter.emit([]);\n  }\n  saveModifications() {\n    this.api.Dictionary.fullSave(this.idDictionary, this.categories)\n      .then(res => {\n        this.categories = [];\n        this.getCache();\n        this.refreshTranslation();\n        console.log(res);\n      });\n  }\n\n  openOutside(translate) {\n    const no = this.route.snapshot.params.noChapter;\n    let url = `${environment.backendServer}/static/${this.idNovel}/${this.idDictionary}/${no}/`;\n    if (translate) {\n      url = 'https://translate.google.com/translate?sl=auto&tl=en&u=' + url;\n    }\n    window.open(url);\n  }\n}\n","<div class=\"dictionaryList\" *ngIf=\"dictionaries.length > 0\">\n    <ul>\n        <li class=\"dictionary-selector\" *ngIf=\"dictionaries.length > 0\">\n            <select class='select' [(ngModel)]=\"dictionarySelector\" (change)=\"dictionarySelected($event.target.value)\">\n                <option value='' selected='selected'>Choose a language</option>\n                <option *ngFor=\"let option of dictionaries\" value=\"{{option.id}}\">{{ option.language }}</option>\n            </select>\n            <input type=\"button\" class=\"button is-small is-info\" value=\"Refresh Translation\" (click)=\"refreshTranslation()\" />\n            <input type=\"button\" class=\"button is-small is-warning\" value=\"Refresh to Original\" (click)=\"refreshOriginal()\" />\n        </li>\n    </ul>\n    <ul>\n        <li class=\"dictionary-buttons\">\n            <input type=\"button\" (click)=\"saveModifications()\" value='Save Modifications'\n                class=\"button is-small is-danger\" />\n            <input type=\"button\" (click)=\"openOutside(true)\" value='Google Translate' class=\"button is-small is-info\" />\n            <input type=\"button\" (click)=\"openOutside(false)\" value='Open Keyword Translated Raw'\n                class=\"button is-small is-warning\" />\n        </li>\n    </ul>\n    <div class=\"interactiveBox\">\n        <ul class='categories'>\n            <ng-container *ngFor=\"let category of categories; let i = index\">\n                <li>\n                    <h1 (click)=\"selectOpenCategory = i\"  [ngClass]=\"{'changed': category.update == true, 'new': category.id == null, 'category-selected': (selectOpenCategory == i) }\">\n                        <input class=\"category-name\" type=\"text\" [(ngModel)]=\"category.name\"\n                                placeholder=\"Category Name\" (ngModelChange)=\"changeCategory(category,i)\" />\n                    </h1>\n                </li>\n            </ng-container>\n            <li>\n                <h1 class=\"categoryButtonRow\">\n                    <input type=\"button\" (click)=\"addCategory()\" value='+ Add new Category' class=\"button is-small is-primary\" />\n                </h1>\n            </li>\n        </ul>\n        <ul class=\"entries\">\n            <li [ngClass]=\"{'hidden': (selectOpenCategory != null)}\">\n                <p class=\"hint\">\n                    &LT;- Select a category\n                </p>\n            </li>\n            <ng-container *ngFor=\"let category of categories; let i = index\">\n                <li [ngClass]=\"{'hidden': (selectOpenCategory != i)}\">\n                    <div *ngFor=\"let entry of category.entries; let j = index\" [ngClass]=\"{'changed': entry.update == true, 'deleted': entry.delete == true, 'new': entry.id == null }\">\n                        <input class=\"entry-original\" type=\"text\" [(ngModel)]=\"entry.entryOriginal\" placeholder=\"Original\" (ngModelChange)=\"changeEntry(entry, i, j)\" />\n                        <input class=\"entry-translation\" type=\"text\" [(ngModel)]=\"entry.entryTranslation\" placeholder=\"Translation\" (ngModelChange)=\"changeEntry(entry, i, j)\" />\n                        <input class=\"entry-description\" type=\"text\" [(ngModel)]=\"entry.description\" placeholder=\"Description\" (ngModelChange)=\"changeEntry(entry, i, j)\" />\n                        <label class=\"deleteButton\">\n                            <i class=\"fas fa-trash\"></i>\n                            <input type=\"checkbox\" class=\"hidden\" [(ngModel)]=\"entry.delete\" title=\"Delete\" (change)=\"changeEntry(entry, i, j)\" />\n                        </label>\n                        <label class=\"resetButton\">\n                            <i class=\"fas fa-sync-alt\"></i>\n                            <input type=\"checkbox\" class=\"hidden\" [(ngModel)]=\"entry.reset\" title=\"Reset\" (change)=\"changeEntry(entry, i, j)\" />\n                        </label>\n                        <!--input  type=\"hidden\" [(ngModel)]=\"entry.update\" /-->\n                        <input type=\"hidden\" [(ngModel)]=\"entry.idCategory\" />\n                    </div>\n                    <input type=\"button\" (click)=\"addEntry(category, category.id)\" value='+ Add new Entry' />\n                </li>\n            </ng-container>\n        </ul>\n    </div>\n    <ul>\n        <li class=\"dictionary-buttons\">\n            <input type=\"button\" (click)=\"saveModifications()\" value='Save Modifications'  class=\"button is-small is-danger\" />\n            <input type=\"button\" (click)=\"openOutside(true)\" value='Google Translate' class=\"button is-small is-info\" />\n            <input type=\"button\" (click)=\"openOutside(false)\" value='Open Keyword Translated Raw'  class=\"button is-small is-warning\" />\n        </li>\n    </ul>\n</div>\n"],"names":[],"sourceRoot":"webpack:///"}