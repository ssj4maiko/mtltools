"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[320],{3320:(et,x,l)=>{l.r(x),l.d(x,{ChapterModule:()=>X});var _=l(6895),d=l(4793),M=l(2340),t=l(4650),h=l(6845);function y(n,c){1&n&&(t.TgZ(0,"div",5),t.TgZ(1,"a",8),t._uU(2,"Import Chapter"),t.qZA(),t.qZA())}function T(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",5),t.TgZ(1,"a",9),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).updateChapters()}),t._uU(2,"Update Chapters"),t.qZA(),t.qZA()}}const P=function(n){return["/novel/",n,"dictionary"]};function Z(n,c){if(1&n&&(t.TgZ(0,"div",4),t.TgZ(1,"div",5),t.TgZ(2,"a",6),t._uU(3,"Dictionary"),t.qZA(),t.qZA(),t.YNc(4,y,3,0,"div",7),t.YNc(5,T,3,0,"div",7),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("routerLink",t.VKq(3,P,e.idNovel)),t.xp6(2),t.Q6J("ngIf",e.novel&&"manual"==e.novel.driver),t.xp6(1),t.Q6J("ngIf",e.novel&&"manual"!=e.novel.driver)}}function b(n,c){1&n&&t.GkF(0)}function w(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"a",15),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw().$implicit;return t.oxw().openGT(a,r)}),t._uU(1),t.qZA()}if(2&n){const e=c.$implicit;t.xp6(1),t.Oqu(e.language)}}function A(n,c){1&n&&(t.TgZ(0,"a",16),t.TgZ(1,"span",17),t._UZ(2,"i",18),t.qZA(),t.qZA())}function N(n,c){1&n&&(t.TgZ(0,"a",19),t.TgZ(1,"span",17),t._UZ(2,"i",20),t.qZA(),t.qZA())}const u=function(n,c){return["/novel/",n,c]};function q(n,c){if(1&n&&(t.ynx(0),t.TgZ(1,"tr",10),t.TgZ(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td",11),t._uU(5),t.qZA(),t.TgZ(6,"td",11),t._uU(7),t.qZA(),t.TgZ(8,"td",11),t._uU(9),t.qZA(),t.TgZ(10,"td"),t.YNc(11,w,2,1,"a",12),t.qZA(),t.YNc(12,A,3,0,"ng-template",null,13,t.W1O),t.YNc(14,N,3,0,"ng-template",null,14,t.W1O),t.qZA(),t.BQk()),2&n){const e=c.$implicit,o=t.oxw();t.xp6(1),t.s9C("title",o.novel.title),t.xp6(2),t.Oqu(e.no),t.xp6(1),t.Q6J("routerLink",t.WLB(9,u,e.idNovel,e.no)),t.xp6(1),t.Oqu(e.title),t.xp6(1),t.Q6J("routerLink",t.WLB(12,u,e.idNovel,e.no)),t.xp6(1),t.Oqu(e.dateOriginalPost),t.xp6(1),t.Q6J("routerLink",t.WLB(15,u,e.idNovel,e.no)),t.xp6(1),t.Oqu(e.dateOriginalRevision),t.xp6(2),t.Q6J("ngForOf",o.dictionaries)}}let k=(()=>{class n{constructor(e,o,i){this.router=e,this.route=o,this.api=i,this.chapters=[],this.dictionaries=[]}ngOnInit(){this.idNovel=this.route.snapshot.params.idNovel,this.api.Novel.get({id:this.idNovel}).then(e=>{this.novel=e,this.api.Dictionary.getAll({idNovel:this.idNovel}).then(o=>{this.dictionaries=Object.values(o),this.api.Chapter.getAll({idNovel:this.idNovel}).then(i=>{this.chapters=Object.values(i)})})})}openGT(e,o){let i=`${M.N.backendServer}/static/${this.idNovel}/${o.id}/${e.no}/1`;i="https://translate.google.com/translate?sl=auto&tl=en&u="+i,window.open(i)}updateChapters(){this.api.Chapter.autoUpdate({idNovel:this.idNovel}).then(e=>{this.api.Chapter.getAll({idNovel:this.idNovel}).then(o=>{this.chapters=Object.values(o)})},e=>{console.log(e)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.F0),t.Y36(d.gz),t.Y36(h.s))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-chapter-list"]],decls:21,vars:2,consts:[["actionButtons",""],[4,"ngTemplateOutlet"],[1,"table","is-striped","is-hoverable","is-fullwidth"],[4,"ngFor","ngForOf"],[1,"columns","actionButtons"],[1,"column"],[1,"button","is-primary",3,"routerLink"],["class","column",4,"ngIf"],["routerLink","['/novel/',idNovel,'add']",1,"button","is-info"],[1,"button","is-info",3,"click"],[3,"title"],[3,"routerLink"],[3,"click",4,"ngFor","ngForOf"],["success",""],["danger",""],[3,"click"],[1,"button","is-success"],[1,"icon","is-small"],[1,"fas","fa-check"],[1,"button","is-danger"],[1,"fas","fa-times"]],template:function(e,o){if(1&e&&(t.YNc(0,Z,6,5,"ng-template",null,0,t.W1O),t.YNc(2,b,1,0,"ng-container",1),t.TgZ(3,"div"),t.TgZ(4,"table",2),t.TgZ(5,"thead"),t.TgZ(6,"tr"),t.TgZ(7,"th"),t._uU(8,"Number"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Title"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Date Created"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Date Updated"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Dictionary"),t._UZ(17,"br"),t._uU(18,"Google Translator"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(19,"tbody"),t.YNc(20,q,16,18,"ng-container",3),t.qZA(),t.qZA(),t.qZA()),2&e){const i=t.MAs(1);t.xp6(2),t.Q6J("ngTemplateOutlet",i),t.xp6(18),t.Q6J("ngForOf",o.chapters)}},directives:[d.yS,_.O5,_.tP,_.sg,d.rH],styles:[".actionButtons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-align:center;width:100%}"]}),n})();var C=l(4131);let S=(()=>{class n{constructor(e){this.api=e,this.categories=[],this.categoriesOriginalValues=[],this.indexes=[]}rebuildCache(e){this.api.Category.getAll({idDictionary:this.idDictionary}).then(o=>{this.categories=Object.values(o);const i=[];this.categories.forEach((r,a)=>{i.push(new Promise((s,g)=>{this.api.Entry.getAll({idDictionary:this.idDictionary,idCategory:r.id}).then(I=>{i.push(new Promise((tt,nt)=>{r.entries=Object.values(I),tt()}))}),s()}))}),Promise.all(i).then(r=>{this.categoriesOriginalValues=JSON.parse(JSON.stringify(this.categories)),e()})})}addEntry(e,o,i){e.entries||(e.entries=[]),e.entries.push(new C.GK),setTimeout(()=>{let r=this.DOMcategories.toArray()[i];if(r){let a=r.nativeElement;a.children[a.children.length-2].children[0].focus()}},100)}addCategory(){this.categories.push(new C.cM(null,this.idDictionary))}changeEntry(e,o,i){e.reset?this.categories[o].entries[i]=this.categories[o].entries[i].id?new C.GK(this.categoriesOriginalValues[o].entries[i]):new C.GK(null,this.categories[o].id):e.delete?e.id||this.categories[o].entries.splice(i,1):e.id&&(e.update=e.entryOriginal!==this.categoriesOriginalValues[o].entries[i].entryOriginal||e.entryTranslation!==this.categoriesOriginalValues[o].entries[i].entryTranslation||e.description!==this.categoriesOriginalValues[o].entries[i].description||e.idCategory!==this.categoriesOriginalValues[o].entries[i].idCategory)}changeCategory(e,o){e.id&&(e.update=e.name!==this.categoriesOriginalValues[o].name)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(h.s))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var p=l(4006);function L(n,c){if(1&n&&(t.TgZ(0,"option",22),t._uU(1),t.qZA()),2&n){const e=c.$implicit;t.s9C("value",e.id),t.xp6(1),t.Oqu(e.language)}}function J(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"li",16),t.TgZ(1,"select",17),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw(2).dictionarySelector=i})("change",function(i){return t.CHM(e),t.oxw(2).dictionarySelected(i.target.value)}),t.TgZ(2,"option",18),t._uU(3,"Choose a language"),t.qZA(),t.YNc(4,L,2,2,"option",19),t.qZA(),t.TgZ(5,"input",20),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).refreshTranslation()}),t.qZA(),t.TgZ(6,"input",21),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).refreshOriginal()}),t.qZA(),t.qZA()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngModel",e.dictionarySelector),t.xp6(3),t.Q6J("ngForOf",e.dictionaries)}}const B=function(n,c,e){return{changed:n,new:c,"category-selected":e}};function D(n,c){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"li"),t.TgZ(2,"h1",23),t.NdJ("click",function(){const r=t.CHM(e).index;return t.oxw(2).selectOpenCategory=r}),t.TgZ(3,"input",24),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.name=i})("ngModelChange",function(){const i=t.CHM(e),r=i.$implicit,a=i.index;return t.oxw(2).changeCategory(r,a)}),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&n){const e=c.$implicit,o=c.index,i=t.oxw(2);t.xp6(2),t.Q6J("ngClass",t.kEZ(2,B,1==e.update,null==e.id,i.selectOpenCategory==o)),t.xp6(1),t.Q6J("ngModel",e.name)}}const Q=function(n,c,e){return{changed:n,deleted:c,new:e}};function H(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",30),t.TgZ(1,"input",31,32),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.entryOriginal=i})("ngModelChange",function(){const i=t.CHM(e),r=i.$implicit,a=i.index,s=t.oxw().index;return t.oxw(2).changeEntry(r,s,a)}),t.qZA(),t.TgZ(3,"input",33),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.entryTranslation=i})("ngModelChange",function(){const i=t.CHM(e),r=i.$implicit,a=i.index,s=t.oxw().index;return t.oxw(2).changeEntry(r,s,a)}),t.qZA(),t.TgZ(4,"input",34),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.description=i})("ngModelChange",function(){const i=t.CHM(e),r=i.$implicit,a=i.index,s=t.oxw().index;return t.oxw(2).changeEntry(r,s,a)}),t.qZA(),t.TgZ(5,"label",35),t._UZ(6,"i",36),t.TgZ(7,"input",37),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.delete=i})("change",function(){const i=t.CHM(e),r=i.$implicit,a=i.index,s=t.oxw().index;return t.oxw(2).changeEntry(r,s,a)}),t.qZA(),t.qZA(),t.TgZ(8,"label",38),t._UZ(9,"i",39),t.TgZ(10,"input",40),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.reset=i})("change",function(){const i=t.CHM(e),r=i.$implicit,a=i.index,s=t.oxw().index;return t.oxw(2).changeEntry(r,s,a)}),t.qZA(),t.qZA(),t.TgZ(11,"input",41),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.idCategory=i}),t.qZA(),t.qZA()}if(2&n){const e=c.$implicit;t.Q6J("ngClass",t.kEZ(7,Q,1==e.update,1==e.delete,null==e.id)),t.xp6(1),t.Q6J("ngModel",e.entryOriginal),t.xp6(2),t.Q6J("ngModel",e.entryTranslation),t.xp6(1),t.Q6J("ngModel",e.description),t.xp6(3),t.Q6J("ngModel",e.delete),t.xp6(3),t.Q6J("ngModel",e.reset),t.xp6(1),t.Q6J("ngModel",e.idCategory)}}const O=function(n){return{hidden:n}};function F(n,c){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"li",14,25),t.TgZ(3,"div",26),t.YNc(4,H,12,11,"div",27),t._UZ(5,"div",28),t.qZA(),t.TgZ(6,"input",29),t.NdJ("click",function(){const i=t.CHM(e),r=i.$implicit,a=i.index;return t.oxw(2).addEntry(r,r.id,a)}),t.qZA(),t.qZA(),t.BQk()}if(2&n){const e=c.$implicit,o=c.index,i=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.VKq(2,O,i.selectOpenCategory!=o)),t.xp6(3),t.Q6J("ngForOf",e.entries)}}function E(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"ul"),t.YNc(2,J,7,2,"li",2),t.qZA(),t.TgZ(3,"ul"),t.TgZ(4,"li",3),t.TgZ(5,"input",4),t.NdJ("click",function(){return t.CHM(e),t.oxw().saveModifications()}),t.qZA(),t.TgZ(6,"input",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().openOutside(!0)}),t.qZA(),t.TgZ(7,"input",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().openOutside(!1)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"div",7),t.TgZ(9,"ul",8),t.YNc(10,D,4,6,"ng-container",9),t.TgZ(11,"li"),t.TgZ(12,"h1",10),t.TgZ(13,"input",11),t.NdJ("click",function(){return t.CHM(e),t.oxw().addCategory()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",12),t.TgZ(15,"ul",13),t.TgZ(16,"li",14),t.TgZ(17,"p",15),t._uU(18," <- Select a category "),t.qZA(),t.qZA(),t.YNc(19,F,7,4,"ng-container",9),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"ul"),t.TgZ(21,"li",3),t.TgZ(22,"input",4),t.NdJ("click",function(){return t.CHM(e),t.oxw().saveModifications()}),t.qZA(),t.TgZ(23,"input",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().openOutside(!0)}),t.qZA(),t.TgZ(24,"input",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().openOutside(!1)}),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.dictionaries.length>0),t.xp6(3),t.Q6J("disabled",e.saving),t.xp6(5),t.Q6J("ngForOf",e.categories),t.xp6(6),t.Q6J("ngClass",t.VKq(6,O,null!=e.selectOpenCategory)),t.xp6(3),t.Q6J("ngForOf",e.categories),t.xp6(3),t.Q6J("disabled",e.saving)}}let f=(()=>{class n extends S{constructor(e,o){super(e),this.api=e,this.route=o,this.Sidebar2Chapter=new t.vpe,this.dictionaries=[],this.categories=[],this.dictionarySelector="",this.saving=!1}ngOnInit(){this.idNovel=this.route.snapshot.params.idNovel,this.api.Dictionary.getAll({idNovel:this.idNovel}).then(e=>{this.dictionaries=e,this.dictionarySelector=e[0].id,this.dictionarySelected(this.dictionarySelector)})}ngOnDestroy(){delete this.dictionaries,delete this.categories,delete this.categoriesOriginalValues,delete this.idCategory,delete this.idDictionary,delete this.idNovel,delete this.dictionarySelector,console.log("destroy Sidebar")}dictionarySelected(e){this.idDictionary=e,this.getCache()}getCache(){0===this.categories.length?this.api.Dictionary.getCache(this.idDictionary).then(e=>{this.PrepareCacheThenTranslate(e)}):this.refreshTranslation()}PrepareCacheThenTranslate(e){e&&new Promise((i,r)=>{this.rebuildCache(i)}).then(i=>{this.refreshTranslation()})}refreshTranslation(){this.Sidebar2Chapter.emit(this.categories)}refreshOriginal(){this.Sidebar2Chapter.emit([])}saveModifications(){this.saving=!0,this.api.Dictionary.fullSave(this.idDictionary,this.categories).then(e=>{this.categories=[],this.getCache(),this.refreshTranslation(),this.saving=!1,console.log(e)})}openOutside(e){let i=`${M.N.backendServer}/static/${this.idNovel}/${this.idDictionary}/${this.route.snapshot.params.noChapter}/`;e&&(i="https://translate.google.com/translate?sl=auto&tl=en&u="+i),window.open(i)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.s),t.Y36(d.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-chapter-sidebar"]],outputs:{Sidebar2Chapter:"Sidebar2Chapter"},features:[t.qOj],decls:1,vars:1,consts:[["class","dictionaryList",4,"ngIf"],[1,"dictionaryList"],["class","dictionary-selector",4,"ngIf"],[1,"dictionary-buttons"],["type","button","value","Save Modifications",1,"button","is-small","is-danger",3,"disabled","click"],["type","button","value","Google Translate",1,"button","is-small","is-info",3,"click"],["type","button","value","Open Keyword Translated Raw",1,"button","is-small","is-warning",3,"click"],[1,"interactiveBox"],[1,"categories"],[4,"ngFor","ngForOf"],[1,"categoryButtonRow"],["type","button","value","+ Add new Category",1,"button","is-small","is-primary",3,"click"],[1,"entries"],[1,"entries-container"],[3,"ngClass"],[1,"hint"],[1,"dictionary-selector"],[1,"select",3,"ngModel","ngModelChange","change"],["value","","selected","selected"],[3,"value",4,"ngFor","ngForOf"],["type","button","value","Refresh Translation",1,"button","is-small","is-info",3,"click"],["type","button","value","Refresh to Original",1,"button","is-small","is-warning",3,"click"],[3,"value"],[3,"ngClass","click"],["type","text","placeholder","Category Name",1,"category-name",3,"ngModel","ngModelChange"],["category",""],[1,"category-entry-container"],["class","entry",3,"ngClass",4,"ngFor","ngForOf"],[1,"entry-spacer"],["type","button","value","+ Add new Entry",1,"addNewEntryButton",3,"click"],[1,"entry",3,"ngClass"],["type","text","placeholder","Original",1,"entry-original",3,"ngModel","ngModelChange"],["entry",""],["type","text","placeholder","Translation",1,"entry-translation",3,"ngModel","ngModelChange"],["type","text","placeholder","Description",1,"entry-description",3,"ngModel","ngModelChange"],[1,"deleteButton"],[1,"fas","fa-trash"],["type","checkbox","title","Delete",1,"hidden",3,"ngModel","ngModelChange","change"],[1,"resetButton"],[1,"fas","fa-sync-alt"],["type","checkbox","title","Reset",1,"hidden",3,"ngModel","ngModelChange","change"],["type","hidden",3,"ngModel","ngModelChange"]],template:function(e,o){1&e&&t.YNc(0,E,25,8,"div",0),2&e&&t.Q6J("ngIf",o.dictionaries.length>0)},directives:[_.O5,p.EJ,p.JJ,p.On,p.YN,p.Kr,_.sg,_.mk,p.Fj,p.Wl],styles:['.dictionaryList[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}.dictionaryList[_ngcontent-%COMP%]   .dictionary-selector[_ngcontent-%COMP%]{align-self:flex-start;width:100%}.dictionaryList[_ngcontent-%COMP%]   .dictionary-selector[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:33.3%;height:100%}.dictionaryList[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{align-self:flex-end}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:500px;flex:1 1 auto}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]{color:#fff;background:rgba(255,255,255,.5);width:30%;float:left;line-height:1.4}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{height:30px;width:100%;background:#2f0050}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   h1.changed[_ngcontent-%COMP%]{background:#009013}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   h1.new[_ngcontent-%COMP%]{background:#000063}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   h1.categoryButtonRow[_ngcontent-%COMP%]{background:#00d1b2}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   h1.categoryButtonRow[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:transparent}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{background-color:transparent;border:0px solid white;color:#fff;outline-width:0px}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]   .category-selected[_ngcontent-%COMP%]{border-width:2px 0px 2px 5px;border-style:solid;border-color:red}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]{width:70%;height:100%;padding:left 10;float:left;overflow:hidden}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{background:black;color:#fff}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]{height:100%}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{height:100%;position:relative;overflow-x:auto}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .category-entry-container[_ngcontent-%COMP%]{overflow-y:auto;height:100%;height:calc(100% - 30px)}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]{width:630px}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]:after{clear:both;content:"";display:block}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]:nth-child(odd){background-color:#555}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry[_ngcontent-%COMP%]:nth-child(even){background-color:#888}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry.changed[_ngcontent-%COMP%]{background-color:green}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry.new[_ngcontent-%COMP%]{background-color:#000063}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry.deleted[_ngcontent-%COMP%]{background-color:#480000}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:transparent;border:0px solid white;color:#fff}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry-original[_ngcontent-%COMP%]{width:100px;float:left}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry-translation[_ngcontent-%COMP%]{width:150px;float:left}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry-description[_ngcontent-%COMP%]{width:300px;float:left}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .deleteButton[_ngcontent-%COMP%]{color:red;margin:0 8px;float:left}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .resetButton[_ngcontent-%COMP%]{color:#00f;margin:0 8px;float:left}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .entry-spacer[_ngcontent-%COMP%]{height:200px}.dictionaryList[_ngcontent-%COMP%]   .interactiveBox[_ngcontent-%COMP%]   .entries[_ngcontent-%COMP%]   .entries-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .addNewEntryButton[_ngcontent-%COMP%]{position:absolute;bottom:0px;left:0px;width:100%;height:30px;text-align:left;border-width:2px 0;border-color:#009013;background-color:#000}.dictionaryList[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{display:none}.dictionaryList[_ngcontent-%COMP%]   .dictionary-buttons[_ngcontent-%COMP%]{width:100%}.dictionaryList[_ngcontent-%COMP%]   .dictionary-buttons[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:33.3%;height:100%}']}),n})();var U=l(1481);const m=function(n,c){return["/novel/",n,c]};function Y(n,c){if(1&n&&(t.TgZ(0,"a",11),t._uU(1," Previous "),t.qZA()),2&n){const e=t.oxw(2);t.Q6J("routerLink",t.WLB(1,m,e.idNovel,e.chapterPrevious.no))}}function $(n,c){if(1&n&&(t.TgZ(0,"a",11),t._uU(1," Next "),t.qZA()),2&n){const e=t.oxw(2);t.Q6J("routerLink",t.WLB(1,m,e.idNovel,e.chapterNext.no))}}const R=function(n){return["/novel/",n]};function j(n,c){if(1&n&&(t.TgZ(0,"div",8),t.TgZ(1,"div",9),t.YNc(2,Y,2,4,"a",10),t.qZA(),t.TgZ(3,"div",9),t.TgZ(4,"a",11),t._uU(5," Table of Contents "),t.qZA(),t.qZA(),t.TgZ(6,"div",9),t.YNc(7,$,2,4,"a",10),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.chapterPrevious),t.xp6(2),t.Q6J("routerLink",t.VKq(3,R,e.idNovel)),t.xp6(3),t.Q6J("ngIf",e.chapterNext)}}function V(n,c){1&n&&t.GkF(0)}function G(n,c){if(1&n&&(t.ynx(0),t.TgZ(1,"h1",12),t._uU(2),t.qZA(),t._UZ(3,"hr"),t._UZ(4,"div",13),t.BQk()),2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.renderedTitle),t.xp6(2),t.s9C("innerHTML",e.renderedText,t.oJD)}}function z(n,c){1&n&&t.GkF(0)}let v=(()=>{class n{constructor(e,o,i,r){this.router=e,this.route=o,this.sanitized=i,this.api=r,this.showSidebar=!0}ngOnInit(){this.loadedChapter=new Promise(e=>{this.loadedChapterResolve=e}),this.startContent()}ngOnDestroy(){delete this.loadedChapter,console.log("destroy detailed chapter")}ngDoCheck(){this.noChapter!==this.route.snapshot.params.noChapter&&(console.log("changing chapter",this.Sidebar.categories),this.ngOnInit(),this.translateText(this.Sidebar.categories))}startContent(){this.idNovel=this.route.snapshot.params.idNovel,this.noChapter=this.route.snapshot.params.noChapter,Promise.all([this.api.Novel.get({id:this.idNovel}),this.api.Chapter.get({idNovel:this.idNovel,no:this.noChapter,text:!0})]).then(e=>{this.novel=e[0],this.chapter=e[1],this.renderDataView(),this.cacheAdjecentChapters(this.noChapter-0),this.loadedChapterResolve()})}cacheAdjecentChapters(e){const o=e-1;o>0&&this.api.Chapter.get({idNovel:this.idNovel,no:o,text:!0}).then(r=>{this.chapterPrevious=r});const i=e-0+1;i<=this.novel.numberChapters&&this.api.Chapter.get({idNovel:this.idNovel,no:i,text:!0}).then(r=>{this.chapterNext=r})}renderDataView(){this.renderedTitle=this.chapter.title,this.renderedText=this.chapter.textRevision?this.chapter.textRevision:this.chapter.textOriginal}translateText(e){this.loadedChapter.then(o=>{if(this.renderDataView(),e.length>0){const i=[];e.forEach(a=>{a.entries.forEach(s=>{const g=s.entryOriginal.length;i[g]||(i[g]=[]),i[g].push({entryOriginal:s.entryOriginal,entryTranslation:s.entryTranslation,idEntry:s.id,idCategory:a.id,category:a.name})})});for(let a=i.length;a>0;--a)i[a]&&i[a].forEach(s=>{const g=new RegExp(s.entryOriginal,"g");this.renderedTitle=this.renderedTitle.replace(g,"[["+s.entryTranslation+"]]"),this.renderedText=this.renderedText.replace(g,"[["+s.entryTranslation+"]]")});let r=new RegExp("\\]\\]\\[\\[","g");this.renderedTitle=this.renderedTitle.replace(r," "),this.renderedText=this.renderedText.replace(r," "),r=new RegExp("\\]\\]","g"),this.renderedTitle=this.renderedTitle.replace(r,""),this.renderedText=this.renderedText.replace(r,""),r=new RegExp("\\[\\[","g"),this.renderedTitle=this.renderedTitle.replace(r,""),this.renderedText=this.renderedText.replace(r,"")}})}toogleSidebar(){this.showSidebar=!this.showSidebar}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.F0),t.Y36(d.gz),t.Y36(U.H7),t.Y36(h.s))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-chapter-detail"]],viewQuery:function(e,o){if(1&e&&t.Gf(f,5),2&e){let i;t.iGM(i=t.CRH())&&(o.Sidebar=i.first)}},decls:11,vars:4,consts:[[1,"flexContent"],[1,"content"],["controlButtons",""],[4,"ngTemplateOutlet"],[4,"ngIf"],[1,"show-sidebar",3,"click"],[1,"sidebar",3,"hidden"],[3,"Sidebar2Chapter"],[1,"columns","controlButtons"],[1,"column"],["class","button is-large is-primary",3,"routerLink",4,"ngIf"],[1,"button","is-large","is-primary",3,"routerLink"],[1,"title"],[1,"novel-content",3,"innerHTML"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.YNc(2,j,8,5,"ng-template",null,2,t.W1O),t.YNc(4,V,1,0,"ng-container",3),t.YNc(5,G,5,2,"ng-container",4),t.YNc(6,z,1,0,"ng-container",3),t.qZA(),t.TgZ(7,"div",5),t.NdJ("click",function(){return o.toogleSidebar()}),t._uU(8,"AHHHHHHH"),t.qZA(),t.TgZ(9,"div",6),t.TgZ(10,"app-chapter-sidebar",7),t.NdJ("Sidebar2Chapter",function(r){return o.translateText(r)}),t.qZA(),t.qZA(),t.qZA()),2&e){const i=t.MAs(3);t.xp6(4),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("ngIf",o.chapter),t.xp6(1),t.Q6J("ngTemplateOutlet",i),t.xp6(3),t.Q6J("hidden",!o.showSidebar)}},styles:[".controlButtons[_ngcontent-%COMP%]{margin-top:1px}.controlButtons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:100%;text-align:center}.title[_ngcontent-%COMP%], .novel-content[_ngcontent-%COMP%]{color:#fff}.flexContent[_ngcontent-%COMP%]{display:flexbox;flex-direction:row;width:100%;height:100%}.flexContent[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{width:calc(100% - 500px);height:100%}.flexContent[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{z-index:20;width:500px;position:fixed;height:100%;right:0px;top:0px;bottom:0px;overflow-y:auto;background:#5e009f}"]}),n})();const W=[{path:"",component:k,data:{title:"List Chapters"}},{path:"dictionary",loadChildren:()=>Promise.all([l.e(399),l.e(259)]).then(l.bind(l,6259)).then(n=>n.DictionaryModule),data:{title:"View dictionary",breadcrumb:"Dictionaries"}},{path:":noChapter",component:v,data:{title:"View chapter",breadcrumb:"View Chapter"}},{path:"**",redirectTo:""}];let K=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[d.Bz.forChild(W)],d.Bz]}),n})(),X=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[_.ez,K,d.Bz,p.u5]]}),n})();t.B6R(v,[_.O5,d.yS,_.tP,f],[])}}]);